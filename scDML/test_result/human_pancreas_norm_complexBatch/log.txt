2023-08-01 14:23:06,171 - root - INFO - Create log file....
2023-08-01 14:23:06,184 - root - INFO - Create scDMLModel Object Done....
2023-08-01 14:23:06,203 - root - INFO - Running preprocess() function...
2023-08-01 14:23:06,265 - root - INFO - mode=unsupervised
2023-08-01 14:23:06,335 - root - INFO - clustering method=louvain
2023-08-01 14:23:06,371 - root - INFO - resolution=1.0
2023-08-01 14:23:06,379 - root - INFO - BATCH_key=BATCH
2023-08-01 14:23:06,387 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-08-01 14:23:06,686 - root - INFO - Log1p data
2023-08-01 14:23:07,010 - root - INFO - Select HVG(n_top_genes=1000)
2023-08-01 14:23:10,347 - root - INFO - Scale batch(scale_value=10.0)
2023-08-01 14:23:12,523 - root - INFO - Calculate PCA(n_comps=100)
2023-08-01 14:23:20,517 - root - INFO - Apply louvain clustring(resolution=1.0) initization
2023-08-01 14:23:20,525 - root - INFO - Number of Cluster =21
2023-08-01 14:23:20,549 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
2023-08-01 14:23:20,563 - root - INFO - Preprocess Dataset Done...
2023-08-01 14:23:20,569 - root - INFO - mode=unsupervised
2023-08-01 14:23:20,612 - root - INFO - K_in=5,K_bw=10
2023-08-01 14:23:20,619 - root - INFO - Calculate similarity of cluster with KNN and MNN
2023-08-01 14:23:20,626 - root - INFO - appoximate calculate KNN Pair intra batch...
2023-08-01 14:23:20,645 - root - INFO - Calculate KNN pair intra batch...........
2023-08-01 14:23:20,652 - root - INFO - K=5
2023-08-01 14:23:20,657 - root - INFO - metric=cosine
2023-08-01 14:23:20,664 - root - INFO - Processing datasets: (0, 0) = ('celseq', 'celseq')
2023-08-01 14:23:20,753 - root - INFO - There are (6636) KNN pairs when processing (0, 0)=('celseq', 'celseq')
2023-08-01 14:23:20,799 - root - INFO - Processing datasets: (1, 1) = ('celseq2', 'celseq2')
2023-08-01 14:23:20,967 - root - INFO - There are (15266) KNN pairs when processing (1, 1)=('celseq2', 'celseq2')
2023-08-01 14:23:20,973 - root - INFO - Processing datasets: (2, 2) = ('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,023 - root - INFO - There are (4020) KNN pairs when processing (2, 2)=('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,029 - root - INFO - Processing datasets: (3, 3) = ('inDrop1', 'inDrop1')
2023-08-01 14:23:21,172 - root - INFO - There are (12568) KNN pairs when processing (3, 3)=('inDrop1', 'inDrop1')
2023-08-01 14:23:21,177 - root - INFO - Processing datasets: (4, 4) = ('inDrop2', 'inDrop2')
2023-08-01 14:23:21,313 - root - INFO - There are (11048) KNN pairs when processing (4, 4)=('inDrop2', 'inDrop2')
2023-08-01 14:23:21,319 - root - INFO - Processing datasets: (5, 5) = ('inDrop3', 'inDrop3')
2023-08-01 14:23:21,614 - root - INFO - There are (24068) KNN pairs when processing (5, 5)=('inDrop3', 'inDrop3')
2023-08-01 14:23:21,619 - root - INFO - Processing datasets: (6, 6) = ('inDrop4', 'inDrop4')
2023-08-01 14:23:21,721 - root - INFO - There are (8364) KNN pairs when processing (6, 6)=('inDrop4', 'inDrop4')
2023-08-01 14:23:21,728 - root - INFO - Processing datasets: (7, 7) = ('smarter', 'smarter')
2023-08-01 14:23:21,869 - root - INFO - There are (9544) KNN pairs when processing (7, 7)=('smarter', 'smarter')
2023-08-01 14:23:21,876 - root - INFO - Processing datasets: (8, 8) = ('smartseq2', 'smartseq2')
2023-08-01 14:23:22,072 - root - INFO - There are (15860) KNN pairs when processing (8, 8)=('smartseq2', 'smartseq2')
2023-08-01 14:23:22,077 - root - INFO - scDML finds (107374) KNN pairs in dataset finally
2023-08-01 14:23:22,195 - root - INFO - appoximate calculate MNN Pair inter batch...
2023-08-01 14:23:22,208 - root - INFO - Calculate MNN pair inter batch...........
2023-08-01 14:23:22,214 - root - INFO - K=10
2023-08-01 14:23:22,218 - root - INFO - metric=cosine
2023-08-01 14:23:22,224 - root - INFO - Processing datasets: (0, 1) = ('celseq', 'celseq2')
2023-08-01 14:23:22,376 - root - INFO - There are (8724) MNN pairs when processing (0, 1)=('celseq', 'celseq2')
2023-08-01 14:23:22,382 - root - INFO - Processing datasets: (0, 2) = ('celseq', 'fluidigmc1')
2023-08-01 14:23:22,486 - root - INFO - There are (4458) MNN pairs when processing (0, 2)=('celseq', 'fluidigmc1')
2023-08-01 14:23:22,500 - root - INFO - Processing datasets: (0, 3) = ('celseq', 'inDrop1')
2023-08-01 14:23:22,676 - root - INFO - There are (7250) MNN pairs when processing (0, 3)=('celseq', 'inDrop1')
2023-08-01 14:23:22,684 - root - INFO - Processing datasets: (0, 4) = ('celseq', 'inDrop2')
2023-08-01 14:23:22,860 - root - INFO - There are (7624) MNN pairs when processing (0, 4)=('celseq', 'inDrop2')
2023-08-01 14:23:22,868 - root - INFO - Processing datasets: (0, 5) = ('celseq', 'inDrop3')
2023-08-01 14:23:23,065 - root - INFO - There are (8982) MNN pairs when processing (0, 5)=('celseq', 'inDrop3')
2023-08-01 14:23:23,073 - root - INFO - Processing datasets: (0, 6) = ('celseq', 'inDrop4')
2023-08-01 14:23:23,187 - root - INFO - There are (7342) MNN pairs when processing (0, 6)=('celseq', 'inDrop4')
2023-08-01 14:23:23,193 - root - INFO - Processing datasets: (0, 7) = ('celseq', 'smarter')
2023-08-01 14:23:23,327 - root - INFO - There are (7080) MNN pairs when processing (0, 7)=('celseq', 'smarter')
2023-08-01 14:23:23,332 - root - INFO - Processing datasets: (0, 8) = ('celseq', 'smartseq2')
2023-08-01 14:23:23,512 - root - INFO - There are (8536) MNN pairs when processing (0, 8)=('celseq', 'smartseq2')
2023-08-01 14:23:23,518 - root - INFO - Processing datasets: (1, 2) = ('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,753 - root - INFO - There are (6758) MNN pairs when processing (1, 2)=('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,758 - root - INFO - Processing datasets: (1, 3) = ('celseq2', 'inDrop1')
2023-08-01 14:23:24,101 - root - INFO - There are (12190) MNN pairs when processing (1, 3)=('celseq2', 'inDrop1')
2023-08-01 14:23:24,118 - root - INFO - Processing datasets: (1, 4) = ('celseq2', 'inDrop2')
2023-08-01 14:23:24,400 - root - INFO - There are (13172) MNN pairs when processing (1, 4)=('celseq2', 'inDrop2')
2023-08-01 14:23:24,408 - root - INFO - Processing datasets: (1, 5) = ('celseq2', 'inDrop3')
2023-08-01 14:23:24,709 - root - INFO - There are (13808) MNN pairs when processing (1, 5)=('celseq2', 'inDrop3')
2023-08-01 14:23:24,715 - root - INFO - Processing datasets: (1, 6) = ('celseq2', 'inDrop4')
2023-08-01 14:23:24,908 - root - INFO - There are (10826) MNN pairs when processing (1, 6)=('celseq2', 'inDrop4')
2023-08-01 14:23:24,921 - root - INFO - Processing datasets: (1, 7) = ('celseq2', 'smarter')
2023-08-01 14:23:25,128 - root - INFO - There are (10402) MNN pairs when processing (1, 7)=('celseq2', 'smarter')
2023-08-01 14:23:25,133 - root - INFO - Processing datasets: (1, 8) = ('celseq2', 'smartseq2')
2023-08-01 14:23:25,391 - root - INFO - There are (14114) MNN pairs when processing (1, 8)=('celseq2', 'smartseq2')
2023-08-01 14:23:25,398 - root - INFO - Processing datasets: (2, 3) = ('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,552 - root - INFO - There are (6966) MNN pairs when processing (2, 3)=('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,557 - root - INFO - Processing datasets: (2, 4) = ('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,699 - root - INFO - There are (7046) MNN pairs when processing (2, 4)=('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,704 - root - INFO - Processing datasets: (2, 5) = ('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,919 - root - INFO - There are (7482) MNN pairs when processing (2, 5)=('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,924 - root - INFO - Processing datasets: (2, 6) = ('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,047 - root - INFO - There are (6548) MNN pairs when processing (2, 6)=('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,052 - root - INFO - Processing datasets: (2, 7) = ('fluidigmc1', 'smarter')
2023-08-01 14:23:26,187 - root - INFO - There are (7470) MNN pairs when processing (2, 7)=('fluidigmc1', 'smarter')
2023-08-01 14:23:26,194 - root - INFO - Processing datasets: (2, 8) = ('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,385 - root - INFO - There are (6936) MNN pairs when processing (2, 8)=('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,392 - root - INFO - Processing datasets: (3, 4) = ('inDrop1', 'inDrop2')
2023-08-01 14:23:26,602 - root - INFO - There are (11496) MNN pairs when processing (3, 4)=('inDrop1', 'inDrop2')
2023-08-01 14:23:26,608 - root - INFO - Processing datasets: (3, 5) = ('inDrop1', 'inDrop3')
2023-08-01 14:23:26,940 - root - INFO - There are (15430) MNN pairs when processing (3, 5)=('inDrop1', 'inDrop3')
2023-08-01 14:23:26,946 - root - INFO - Processing datasets: (3, 6) = ('inDrop1', 'inDrop4')
2023-08-01 14:23:27,153 - root - INFO - There are (11254) MNN pairs when processing (3, 6)=('inDrop1', 'inDrop4')
2023-08-01 14:23:27,158 - root - INFO - Processing datasets: (3, 7) = ('inDrop1', 'smarter')
2023-08-01 14:23:27,365 - root - INFO - There are (10128) MNN pairs when processing (3, 7)=('inDrop1', 'smarter')
2023-08-01 14:23:27,370 - root - INFO - Processing datasets: (3, 8) = ('inDrop1', 'smartseq2')
2023-08-01 14:23:27,629 - root - INFO - There are (10960) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2023-08-01 14:23:27,634 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2023-08-01 14:23:27,906 - root - INFO - There are (13638) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2023-08-01 14:23:27,910 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2023-08-01 14:23:28,104 - root - INFO - There are (10954) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2023-08-01 14:23:28,108 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2023-08-01 14:23:28,307 - root - INFO - There are (10822) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2023-08-01 14:23:28,313 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2023-08-01 14:23:28,584 - root - INFO - There are (13528) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2023-08-01 14:23:28,589 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2023-08-01 14:23:28,910 - root - INFO - There are (11956) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2023-08-01 14:23:28,917 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2023-08-01 14:23:29,284 - root - INFO - There are (12598) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2023-08-01 14:23:29,293 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2023-08-01 14:23:29,666 - root - INFO - There are (14218) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2023-08-01 14:23:29,670 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2023-08-01 14:23:29,865 - root - INFO - There are (8780) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2023-08-01 14:23:29,872 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2023-08-01 14:23:30,170 - root - INFO - There are (10418) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2023-08-01 14:23:30,175 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2023-08-01 14:23:30,433 - root - INFO - There are (10360) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2023-08-01 14:23:30,439 - root - INFO - scDML finds (360254) MNN pairs in dataset finally
2023-08-01 14:23:31,944 - root - INFO - Find All Nearest Neighbours Done....
2023-08-01 14:23:31,952 - root - INFO - calculate similarity matrix between cluster
2023-08-01 14:23:32,018 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,036 - root - INFO - 7170 knn pair in batch link different cluster
2023-08-01 14:23:32,131 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,162 - root - INFO - 173710 mnn pair in batch link different cluster
2023-08-01 14:23:32,198 - root - INFO - ===================================================================================
2023-08-01 14:23:32,220 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=24.22733612273361
2023-08-01 14:23:32,247 - root - INFO - ===================================================================================
2023-08-01 14:23:32,290 - root - INFO - save cor matrix to file....
2023-08-01 14:23:32,301 - root - INFO - save nn pair matrix to file
2023-08-01 14:23:32,308 - root - INFO - Calculate Similarity Matrix Done....
2023-08-01 14:23:32,460 - root - INFO - scDML merge cluster with rule2....
2023-08-01 14:23:32,467 - root - INFO - merge_rule2....
2023-08-01 14:23:32,574 - root - INFO - merging cluster set:[{5}, {6}, {8}, {10}, {11}, {13}, {14}, {16}, {17}, {19}, {20}, {9, 18, 1, 7}, {2, 12}, {0, 3, 4, 15}]
2023-08-01 14:23:32,581 - root - INFO - Build Embedding Net for scDML training
2023-08-01 14:23:32,590 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-08-01 14:23:32,596 - root - INFO - Build Embedding Net Done...
2023-08-01 14:23:32,601 - root - INFO - train scDML(expect_num_cluster=14) with Embedding Net
2023-08-01 14:23:32,607 - root - INFO - expect_num_cluster=14
2023-08-01 14:23:32,626 - root - INFO - using CPU to train model
2023-08-01 14:23:32,637 - root - INFO - use euclidean distance and hard triplet to train model
2023-08-01 14:23:32,644 - root - INFO - not use earlystopping!!!!
2023-08-01 14:23:34,410 - root - INFO - epoch=1,number_hard_triplet=135494
2023-08-01 14:23:36,158 - root - INFO - epoch=2,number_hard_triplet=44181
2023-08-01 14:23:37,817 - root - INFO - epoch=3,number_hard_triplet=25542
2023-08-01 14:23:39,353 - root - INFO - epoch=4,number_hard_triplet=16022
2023-08-01 14:23:40,748 - root - INFO - epoch=5,number_hard_triplet=8235
2023-08-01 14:23:42,224 - root - INFO - epoch=6,number_hard_triplet=6354
2023-08-01 14:23:43,519 - root - INFO - epoch=7,number_hard_triplet=4941
2023-08-01 14:23:45,091 - root - INFO - epoch=8,number_hard_triplet=3500
2023-08-01 14:23:46,402 - root - INFO - epoch=9,number_hard_triplet=3064
2023-08-01 14:23:47,735 - root - INFO - epoch=10,number_hard_triplet=2192
2023-08-01 14:23:49,199 - root - INFO - epoch=11,number_hard_triplet=1760
2023-08-01 14:23:50,554 - root - INFO - epoch=12,number_hard_triplet=1130
2023-08-01 14:23:52,722 - root - INFO - epoch=13,number_hard_triplet=1150
2023-08-01 14:23:55,101 - root - INFO - epoch=14,number_hard_triplet=897
2023-08-01 14:23:56,924 - root - INFO - epoch=15,number_hard_triplet=1113
2023-08-01 14:23:58,285 - root - INFO - epoch=16,number_hard_triplet=817
2023-08-01 14:24:00,337 - root - INFO - epoch=17,number_hard_triplet=714
2023-08-01 14:24:02,595 - root - INFO - epoch=18,number_hard_triplet=682
2023-08-01 14:24:04,712 - root - INFO - epoch=19,number_hard_triplet=442
2023-08-01 14:24:07,234 - root - INFO - epoch=20,number_hard_triplet=441
2023-08-01 14:24:08,761 - root - INFO - epoch=21,number_hard_triplet=355
2023-08-01 14:24:10,218 - root - INFO - epoch=22,number_hard_triplet=497
2023-08-01 14:24:11,506 - root - INFO - epoch=23,number_hard_triplet=518
2023-08-01 14:24:13,059 - root - INFO - epoch=24,number_hard_triplet=370
2023-08-01 14:24:14,493 - root - INFO - epoch=25,number_hard_triplet=235
2023-08-01 14:24:16,204 - root - INFO - epoch=26,number_hard_triplet=476
2023-08-01 14:24:17,504 - root - INFO - epoch=27,number_hard_triplet=237
2023-08-01 14:24:19,040 - root - INFO - epoch=28,number_hard_triplet=269
2023-08-01 14:24:21,251 - root - INFO - epoch=29,number_hard_triplet=343
2023-08-01 14:24:23,098 - root - INFO - epoch=30,number_hard_triplet=277
2023-08-01 14:24:25,119 - root - INFO - epoch=31,number_hard_triplet=290
2023-08-01 14:24:26,756 - root - INFO - epoch=32,number_hard_triplet=263
2023-08-01 14:24:28,288 - root - INFO - epoch=33,number_hard_triplet=246
2023-08-01 14:24:29,658 - root - INFO - epoch=34,number_hard_triplet=278
2023-08-01 14:24:31,080 - root - INFO - epoch=35,number_hard_triplet=222
2023-08-01 14:24:32,422 - root - INFO - epoch=36,number_hard_triplet=137
2023-08-01 14:24:35,286 - root - INFO - epoch=37,number_hard_triplet=143
2023-08-01 14:24:36,838 - root - INFO - epoch=38,number_hard_triplet=135
2023-08-01 14:24:38,177 - root - INFO - epoch=39,number_hard_triplet=251
2023-08-01 14:24:40,457 - root - INFO - epoch=40,number_hard_triplet=184
2023-08-01 14:24:42,006 - root - INFO - epoch=41,number_hard_triplet=205
2023-08-01 14:24:43,518 - root - INFO - epoch=42,number_hard_triplet=223
2023-08-01 14:24:44,853 - root - INFO - epoch=43,number_hard_triplet=185
2023-08-01 14:24:46,998 - root - INFO - epoch=44,number_hard_triplet=145
2023-08-01 14:24:48,525 - root - INFO - epoch=45,number_hard_triplet=128
2023-08-01 14:24:50,370 - root - INFO - epoch=46,number_hard_triplet=158
2023-08-01 14:24:54,551 - root - INFO - epoch=47,number_hard_triplet=162
2023-08-01 14:24:57,167 - root - INFO - epoch=48,number_hard_triplet=124
2023-08-01 14:24:59,603 - root - INFO - epoch=49,number_hard_triplet=207
2023-08-01 14:25:02,320 - root - INFO - epoch=50,number_hard_triplet=229
2023-08-01 14:25:02,338 - root - INFO - scDML training done....
2023-08-01 14:25:02,346 - root - INFO - extract embedding for dataset with trained network
2023-08-01 14:25:17,417 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
4 - root - INFO - Create scDMLModel Object Done....
2023-08-01 14:23:06,203 - root - INFO - Running preprocess() function...
2023-08-01 14:23:06,265 - root - INFO - mode=unsupervised
2023-08-01 14:23:06,335 - root - INFO - clustering method=louvain
2023-08-01 14:23:06,371 - root - INFO - resolution=1.0
2023-08-01 14:23:06,379 - root - INFO - BATCH_key=BATCH
2023-08-01 14:23:06,387 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-08-01 14:23:06,686 - root - INFO - Log1p data
2023-08-01 14:23:07,010 - root - INFO - Select HVG(n_top_genes=1000)
2023-08-01 14:23:10,347 - root - INFO - Scale batch(scale_value=10.0)
2023-08-01 14:23:12,523 - root - INFO - Calculate PCA(n_comps=100)
2023-08-01 14:23:20,517 - root - INFO - Apply louvain clustring(resolution=1.0) initization
2023-08-01 14:23:20,525 - root - INFO - Number of Cluster =21
2023-08-01 14:23:20,549 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
2023-08-01 14:23:20,563 - root - INFO - Preprocess Dataset Done...
2023-08-01 14:23:20,569 - root - INFO - mode=unsupervised
2023-08-01 14:23:20,612 - root - INFO - K_in=5,K_bw=10
2023-08-01 14:23:20,619 - root - INFO - Calculate similarity of cluster with KNN and MNN
2023-08-01 14:23:20,626 - root - INFO - appoximate calculate KNN Pair intra batch...
2023-08-01 14:23:20,645 - root - INFO - Calculate KNN pair intra batch...........
2023-08-01 14:23:20,652 - root - INFO - K=5
2023-08-01 14:23:20,657 - root - INFO - metric=cosine
2023-08-01 14:23:20,664 - root - INFO - Processing datasets: (0, 0) = ('celseq', 'celseq')
2023-08-01 14:23:20,753 - root - INFO - There are (6636) KNN pairs when processing (0, 0)=('celseq', 'celseq')
2023-08-01 14:23:20,799 - root - INFO - Processing datasets: (1, 1) = ('celseq2', 'celseq2')
2023-08-01 14:23:20,967 - root - INFO - There are (15266) KNN pairs when processing (1, 1)=('celseq2', 'celseq2')
2023-08-01 14:23:20,973 - root - INFO - Processing datasets: (2, 2) = ('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,023 - root - INFO - There are (4020) KNN pairs when processing (2, 2)=('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,029 - root - INFO - Processing datasets: (3, 3) = ('inDrop1', 'inDrop1')
2023-08-01 14:23:21,172 - root - INFO - There are (12568) KNN pairs when processing (3, 3)=('inDrop1', 'inDrop1')
2023-08-01 14:23:21,177 - root - INFO - Processing datasets: (4, 4) = ('inDrop2', 'inDrop2')
2023-08-01 14:23:21,313 - root - INFO - There are (11048) KNN pairs when processing (4, 4)=('inDrop2', 'inDrop2')
2023-08-01 14:23:21,319 - root - INFO - Processing datasets: (5, 5) = ('inDrop3', 'inDrop3')
2023-08-01 14:23:21,614 - root - INFO - There are (24068) KNN pairs when processing (5, 5)=('inDrop3', 'inDrop3')
2023-08-01 14:23:21,619 - root - INFO - Processing datasets: (6, 6) = ('inDrop4', 'inDrop4')
2023-08-01 14:23:21,721 - root - INFO - There are (8364) KNN pairs when processing (6, 6)=('inDrop4', 'inDrop4')
2023-08-01 14:23:21,728 - root - INFO - Processing datasets: (7, 7) = ('smarter', 'smarter')
2023-08-01 14:23:21,869 - root - INFO - There are (9544) KNN pairs when processing (7, 7)=('smarter', 'smarter')
2023-08-01 14:23:21,876 - root - INFO - Processing datasets: (8, 8) = ('smartseq2', 'smartseq2')
2023-08-01 14:23:22,072 - root - INFO - There are (15860) KNN pairs when processing (8, 8)=('smartseq2', 'smartseq2')
2023-08-01 14:23:22,077 - root - INFO - scDML finds (107374) KNN pairs in dataset finally
2023-08-01 14:23:22,195 - root - INFO - appoximate calculate MNN Pair inter batch...
2023-08-01 14:23:22,208 - root - INFO - Calculate MNN pair inter batch...........
2023-08-01 14:23:22,214 - root - INFO - K=10
2023-08-01 14:23:22,218 - root - INFO - metric=cosine
2023-08-01 14:23:22,224 - root - INFO - Processing datasets: (0, 1) = ('celseq', 'celseq2')
2023-08-01 14:23:22,376 - root - INFO - There are (8724) MNN pairs when processing (0, 1)=('celseq', 'celseq2')
2023-08-01 14:23:22,382 - root - INFO - Processing datasets: (0, 2) = ('celseq', 'fluidigmc1')
2023-08-01 14:23:22,486 - root - INFO - There are (4458) MNN pairs when processing (0, 2)=('celseq', 'fluidigmc1')
2023-08-01 14:23:22,500 - root - INFO - Processing datasets: (0, 3) = ('celseq', 'inDrop1')
2023-08-01 14:23:22,676 - root - INFO - There are (7250) MNN pairs when processing (0, 3)=('celseq', 'inDrop1')
2023-08-01 14:23:22,684 - root - INFO - Processing datasets: (0, 4) = ('celseq', 'inDrop2')
2023-08-01 14:23:22,860 - root - INFO - There are (7624) MNN pairs when processing (0, 4)=('celseq', 'inDrop2')
2023-08-01 14:23:22,868 - root - INFO - Processing datasets: (0, 5) = ('celseq', 'inDrop3')
2023-08-01 14:23:23,065 - root - INFO - There are (8982) MNN pairs when processing (0, 5)=('celseq', 'inDrop3')
2023-08-01 14:23:23,073 - root - INFO - Processing datasets: (0, 6) = ('celseq', 'inDrop4')
2023-08-01 14:23:23,187 - root - INFO - There are (7342) MNN pairs when processing (0, 6)=('celseq', 'inDrop4')
2023-08-01 14:23:23,193 - root - INFO - Processing datasets: (0, 7) = ('celseq', 'smarter')
2023-08-01 14:23:23,327 - root - INFO - There are (7080) MNN pairs when processing (0, 7)=('celseq', 'smarter')
2023-08-01 14:23:23,332 - root - INFO - Processing datasets: (0, 8) = ('celseq', 'smartseq2')
2023-08-01 14:23:23,512 - root - INFO - There are (8536) MNN pairs when processing (0, 8)=('celseq', 'smartseq2')
2023-08-01 14:23:23,518 - root - INFO - Processing datasets: (1, 2) = ('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,753 - root - INFO - There are (6758) MNN pairs when processing (1, 2)=('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,758 - root - INFO - Processing datasets: (1, 3) = ('celseq2', 'inDrop1')
2023-08-01 14:23:24,101 - root - INFO - There are (12190) MNN pairs when processing (1, 3)=('celseq2', 'inDrop1')
2023-08-01 14:23:24,118 - root - INFO - Processing datasets: (1, 4) = ('celseq2', 'inDrop2')
2023-08-01 14:23:24,400 - root - INFO - There are (13172) MNN pairs when processing (1, 4)=('celseq2', 'inDrop2')
2023-08-01 14:23:24,408 - root - INFO - Processing datasets: (1, 5) = ('celseq2', 'inDrop3')
2023-08-01 14:23:24,709 - root - INFO - There are (13808) MNN pairs when processing (1, 5)=('celseq2', 'inDrop3')
2023-08-01 14:23:24,715 - root - INFO - Processing datasets: (1, 6) = ('celseq2', 'inDrop4')
2023-08-01 14:23:24,908 - root - INFO - There are (10826) MNN pairs when processing (1, 6)=('celseq2', 'inDrop4')
2023-08-01 14:23:24,921 - root - INFO - Processing datasets: (1, 7) = ('celseq2', 'smarter')
2023-08-01 14:23:25,128 - root - INFO - There are (10402) MNN pairs when processing (1, 7)=('celseq2', 'smarter')
2023-08-01 14:23:25,133 - root - INFO - Processing datasets: (1, 8) = ('celseq2', 'smartseq2')
2023-08-01 14:23:25,391 - root - INFO - There are (14114) MNN pairs when processing (1, 8)=('celseq2', 'smartseq2')
2023-08-01 14:23:25,398 - root - INFO - Processing datasets: (2, 3) = ('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,552 - root - INFO - There are (6966) MNN pairs when processing (2, 3)=('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,557 - root - INFO - Processing datasets: (2, 4) = ('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,699 - root - INFO - There are (7046) MNN pairs when processing (2, 4)=('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,704 - root - INFO - Processing datasets: (2, 5) = ('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,919 - root - INFO - There are (7482) MNN pairs when processing (2, 5)=('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,924 - root - INFO - Processing datasets: (2, 6) = ('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,047 - root - INFO - There are (6548) MNN pairs when processing (2, 6)=('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,052 - root - INFO - Processing datasets: (2, 7) = ('fluidigmc1', 'smarter')
2023-08-01 14:23:26,187 - root - INFO - There are (7470) MNN pairs when processing (2, 7)=('fluidigmc1', 'smarter')
2023-08-01 14:23:26,194 - root - INFO - Processing datasets: (2, 8) = ('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,385 - root - INFO - There are (6936) MNN pairs when processing (2, 8)=('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,392 - root - INFO - Processing datasets: (3, 4) = ('inDrop1', 'inDrop2')
2023-08-01 14:23:26,602 - root - INFO - There are (11496) MNN pairs when processing (3, 4)=('inDrop1', 'inDrop2')
2023-08-01 14:23:26,608 - root - INFO - Processing datasets: (3, 5) = ('inDrop1', 'inDrop3')
2023-08-01 14:23:26,940 - root - INFO - There are (15430) MNN pairs when processing (3, 5)=('inDrop1', 'inDrop3')
2023-08-01 14:23:26,946 - root - INFO - Processing datasets: (3, 6) = ('inDrop1', 'inDrop4')
2023-08-01 14:23:27,153 - root - INFO - There are (11254) MNN pairs when processing (3, 6)=('inDrop1', 'inDrop4')
2023-08-01 14:23:27,158 - root - INFO - Processing datasets: (3, 7) = ('inDrop1', 'smarter')
2023-08-01 14:23:27,365 - root - INFO - There are (10128) MNN pairs when processing (3, 7)=('inDrop1', 'smarter')
2023-08-01 14:23:27,370 - root - INFO - Processing datasets: (3, 8) = ('inDrop1', 'smartseq2')
2023-08-01 14:23:27,629 - root - INFO - There are (10960) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2023-08-01 14:23:27,634 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2023-08-01 14:23:27,906 - root - INFO - There are (13638) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2023-08-01 14:23:27,910 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2023-08-01 14:23:28,104 - root - INFO - There are (10954) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2023-08-01 14:23:28,108 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2023-08-01 14:23:28,307 - root - INFO - There are (10822) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2023-08-01 14:23:28,313 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2023-08-01 14:23:28,584 - root - INFO - There are (13528) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2023-08-01 14:23:28,589 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2023-08-01 14:23:28,910 - root - INFO - There are (11956) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2023-08-01 14:23:28,917 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2023-08-01 14:23:29,284 - root - INFO - There are (12598) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2023-08-01 14:23:29,293 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2023-08-01 14:23:29,666 - root - INFO - There are (14218) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2023-08-01 14:23:29,670 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2023-08-01 14:23:29,865 - root - INFO - There are (8780) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2023-08-01 14:23:29,872 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2023-08-01 14:23:30,170 - root - INFO - There are (10418) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2023-08-01 14:23:30,175 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2023-08-01 14:23:30,433 - root - INFO - There are (10360) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2023-08-01 14:23:30,439 - root - INFO - scDML finds (360254) MNN pairs in dataset finally
2023-08-01 14:23:31,944 - root - INFO - Find All Nearest Neighbours Done....
2023-08-01 14:23:31,952 - root - INFO - calculate similarity matrix between cluster
2023-08-01 14:23:32,018 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,036 - root - INFO - 7170 knn pair in batch link different cluster
2023-08-01 14:23:32,131 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,162 - root - INFO - 173710 mnn pair in batch link different cluster
2023-08-01 14:23:32,198 - root - INFO - ===================================================================================
2023-08-01 14:23:32,220 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=24.22733612273361
2023-08-01 14:23:32,247 - root - INFO - ===================================================================================
2023-08-01 14:23:32,290 - root - INFO - save cor matrix to file....
2023-08-01 14:23:32,301 - root - INFO - save nn pair matrix to file
2023-08-01 14:23:32,308 - root - INFO - Calculate Similarity Matrix Done....
2023-08-01 14:23:32,460 - root - INFO - scDML merge cluster with rule2....
2023-08-01 14:23:32,467 - root - INFO - merge_rule2....
2023-08-01 14:23:32,574 - root - INFO - merging cluster set:[{5}, {6}, {8}, {10}, {11}, {13}, {14}, {16}, {17}, {19}, {20}, {9, 18, 1, 7}, {2, 12}, {0, 3, 4, 15}]
2023-08-01 14:23:32,581 - root - INFO - Build Embedding Net for scDML training
2023-08-01 14:23:32,590 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-08-01 14:23:32,596 - root - INFO - Build Embedding Net Done...
2023-08-01 14:23:32,601 - root - INFO - train scDML(expect_num_cluster=14) with Embedding Net
2023-08-01 14:23:32,607 - root - INFO - expect_num_cluster=14
2023-08-01 14:23:32,626 - root - INFO - using CPU to train model
2023-08-01 14:23:32,637 - root - INFO - use euclidean distance and hard triplet to train model
2023-08-01 14:23:32,644 - root - INFO - not use earlystopping!!!!
2023-08-01 14:23:34,410 - root - INFO - epoch=1,number_hard_triplet=135494
2023-08-01 14:23:36,158 - root - INFO - epoch=2,number_hard_triplet=44181
2023-08-01 14:23:37,817 - root - INFO - epoch=3,number_hard_triplet=25542
2023-08-01 14:23:39,353 - root - INFO - epoch=4,number_hard_triplet=16022
2023-08-01 14:23:40,748 - root - INFO - epoch=5,number_hard_triplet=8235
2023-08-01 14:23:42,224 - root - INFO - epoch=6,number_hard_triplet=6354
2023-08-01 14:23:43,519 - root - INFO - epoch=7,number_hard_triplet=4941
2023-08-01 14:23:45,091 - root - INFO - epoch=8,number_hard_triplet=3500
2023-08-01 14:23:46,402 - root - INFO - epoch=9,number_hard_triplet=3064
2023-08-01 14:23:47,735 - root - INFO - epoch=10,number_hard_triplet=2192
2023-08-01 14:23:49,199 - root - INFO - epoch=11,number_hard_triplet=1760
2023-08-01 14:23:50,554 - root - INFO - epoch=12,number_hard_triplet=1130
2023-08-01 14:23:52,722 - root - INFO - epoch=13,number_hard_triplet=1150
2023-08-01 14:23:55,101 - root - INFO - epoch=14,number_hard_triplet=897
2023-08-01 14:23:56,924 - root - INFO - epoch=15,number_hard_triplet=1113
2023-08-01 14:23:58,285 - root - INFO - epoch=16,number_hard_triplet=817
2023-08-01 14:24:00,337 - root - INFO - epoch=17,number_hard_triplet=714
2023-08-01 14:24:02,595 - root - INFO - epoch=18,number_hard_triplet=682
2023-08-01 14:24:04,712 - root - INFO - epoch=19,number_hard_triplet=442
2023-08-01 14:24:07,234 - root - INFO - epoch=20,number_hard_triplet=441
2023-08-01 14:24:08,761 - root - INFO - epoch=21,number_hard_triplet=355
2023-08-01 14:24:10,218 - root - INFO - epoch=22,number_hard_triplet=497
2023-08-01 14:24:11,506 - root - INFO - epoch=23,number_hard_triplet=518
2023-08-01 14:24:13,059 - root - INFO - epoch=24,number_hard_triplet=370
2023-08-01 14:24:14,493 - root - INFO - epoch=25,number_hard_triplet=235
2023-08-01 14:24:16,204 - root - INFO - epoch=26,number_hard_triplet=476
2023-08-01 14:24:17,504 - root - INFO - epoch=27,number_hard_triplet=237
2023-08-01 14:24:19,040 - root - INFO - epoch=28,number_hard_triplet=269
2023-08-01 14:24:21,251 - root - INFO - epoch=29,number_hard_triplet=343
2023-08-01 14:24:23,098 - root - INFO - epoch=30,number_hard_triplet=277
2023-08-01 14:24:25,119 - root - INFO - epoch=31,number_hard_triplet=290
2023-08-01 14:24:26,756 - root - INFO - epoch=32,number_hard_triplet=263
2023-08-01 14:24:28,288 - root - INFO - epoch=33,number_hard_triplet=246
2023-08-01 14:24:29,658 - root - INFO - epoch=34,number_hard_triplet=278
2023-08-01 14:24:31,080 - root - INFO - epoch=35,number_hard_triplet=222
2023-08-01 14:24:32,422 - root - INFO - epoch=36,number_hard_triplet=137
2023-08-01 14:24:35,286 - root - INFO - epoch=37,number_hard_triplet=143
2023-08-01 14:24:36,838 - root - INFO - epoch=38,number_hard_triplet=135
2023-08-01 14:24:38,177 - root - INFO - epoch=39,number_hard_triplet=251
2023-08-01 14:24:40,457 - root - INFO - epoch=40,number_hard_triplet=184
2023-08-01 14:24:42,006 - root - INFO - epoch=41,number_hard_triplet=205
2023-08-01 14:24:43,518 - root - INFO - epoch=42,number_hard_triplet=223
2023-08-01 14:24:44,853 - root - INFO - epoch=43,number_hard_triplet=185
2023-08-01 14:24:46,998 - root - INFO - epoch=44,number_hard_triplet=145
2023-08-01 14:24:48,525 - root - INFO - epoch=45,number_hard_triplet=128
2023-08-01 14:24:50,370 - root - INFO - epoch=46,number_hard_triplet=158
2023-08-01 14:24:54,551 - root - INFO - epoch=47,number_hard_triplet=162
2023-08-01 14:24:57,167 - root - INFO - epoch=48,number_hard_triplet=124
2023-08-01 14:24:59,603 - root - INFO - epoch=49,number_hard_triplet=207
2023-08-01 14:25:02,320 - root - INFO - epoch=50,number_hard_triplet=229
2023-08-01 14:25:02,338 - root - INFO - scDML training done....
2023-08-01 14:25:02,346 - root - INFO - extract embedding for dataset with trained network
2023-08-01 14:25:17,417 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
