2023-08-16 14:26:51,994 - root - INFO - Create log file....
2023-08-16 14:26:51,997 - root - INFO - Create scDMLModel Object Done....
2023-08-16 14:26:52,000 - root - INFO - Running preprocess() function...
2023-08-16 14:26:52,002 - root - INFO - mode=unsupervised
2023-08-16 14:26:52,004 - root - INFO - clustering method=louvain
2023-08-16 14:26:52,004 - root - INFO - resolution=1.0
2023-08-16 14:26:52,005 - root - INFO - BATCH_key=BATCH
2023-08-16 14:26:52,007 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-08-16 14:26:52,116 - root - INFO - Log1p data
2023-08-16 14:26:52,148 - root - INFO - Select HVG(n_top_genes=1000)
2023-08-16 14:26:53,531 - root - INFO - Scale batch(scale_value=10.0)
2023-08-16 14:26:54,002 - root - INFO - Calculate PCA(n_comps=100)
2023-08-16 14:27:00,532 - root - INFO - Apply louvain clustring(resolution=1.0) initization
2023-08-16 14:27:00,535 - root - INFO - Number of Cluster =12
2023-08-16 14:27:00,537 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
2023-08-16 14:27:00,539 - root - INFO - Preprocess Dataset Done...
2023-08-16 14:27:00,540 - root - INFO - mode=unsupervised
2023-08-16 14:27:00,571 - root - INFO - K_in=5,K_bw=10
2023-08-16 14:27:00,573 - root - INFO - Calculate similarity of cluster with KNN and MNN
2023-08-16 14:27:00,574 - root - INFO - appoximate calculate KNN Pair intra batch...
2023-08-16 14:27:00,580 - root - INFO - Calculate KNN pair intra batch...........
2023-08-16 14:27:00,581 - root - INFO - K=5
2023-08-16 14:27:00,582 - root - INFO - metric=cosine
2023-08-16 14:27:00,583 - root - INFO - Processing datasets: (0, 0) = ('0', '0')
2023-08-16 14:27:01,397 - root - INFO - There are (38806) KNN pairs when processing (0, 0)=('0', '0')
2023-08-16 14:27:01,398 - root - INFO - Processing datasets: (1, 1) = ('1', '1')
2023-08-16 14:27:01,899 - root - INFO - There are (34078) KNN pairs when processing (1, 1)=('1', '1')
2023-08-16 14:27:01,900 - root - INFO - scDML finds (72884) KNN pairs in dataset finally
2023-08-16 14:27:01,975 - root - INFO - appoximate calculate MNN Pair inter batch...
2023-08-16 14:27:01,982 - root - INFO - Calculate MNN pair inter batch...........
2023-08-16 14:27:01,983 - root - INFO - K=10
2023-08-16 14:27:01,984 - root - INFO - metric=cosine
2023-08-16 14:27:01,984 - root - INFO - Processing datasets: (0, 1) = ('0', '1')
2023-08-16 14:27:02,641 - root - INFO - There are (40930) MNN pairs when processing (0, 1)=('0', '1')
2023-08-16 14:27:02,642 - root - INFO - scDML finds (40930) MNN pairs in dataset finally
2023-08-16 14:27:02,692 - root - INFO - Find All Nearest Neighbours Done....
2023-08-16 14:27:02,694 - root - INFO - calculate similarity matrix between cluster
2023-08-16 14:27:02,732 - root - INFO - delete inner edge which link same cluster
2023-08-16 14:27:02,733 - root - INFO - 18966 knn pair in batch link different cluster
2023-08-16 14:27:02,761 - root - INFO - delete inner edge which link same cluster
2023-08-16 14:27:02,763 - root - INFO - 9658 mnn pair in batch link different cluster
2023-08-16 14:27:02,764 - root - INFO - ===================================================================================
2023-08-16 14:27:02,765 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=0.5092270378572182
2023-08-16 14:27:02,765 - root - INFO - ===================================================================================
2023-08-16 14:27:02,768 - root - INFO - save cor matrix to file....
2023-08-16 14:27:02,770 - root - INFO - save nn pair matrix to file
2023-08-16 14:27:02,772 - root - INFO - Calculate Similarity Matrix Done....
2023-08-16 14:27:02,790 - root - INFO - scDML merge cluster with rule2....
2023-08-16 14:27:02,793 - root - INFO - merge_rule2....
2023-08-16 14:27:02,801 - root - INFO - merging cluster set:[{0}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}]
2023-08-16 14:27:02,803 - root - INFO - Build Embedding Net for scDML training
2023-08-16 14:27:02,808 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-08-16 14:27:02,809 - root - INFO - Build Embedding Net Done...
2023-08-16 14:27:02,811 - root - INFO - train scDML(expect_num_cluster=24) with Embedding Net
2023-08-16 14:27:02,811 - root - INFO - expect_num_cluster=24
2023-08-16 14:27:02,813 - root - INFO - using CPU to train model
2023-08-16 14:27:02,814 - root - INFO - use euclidean distance and hard triplet to train model
2023-08-16 14:27:02,815 - root - INFO - not use earlystopping!!!!
2023-08-16 14:27:04,943 - root - INFO - epoch=1,number_hard_triplet=689524
2023-08-16 14:27:06,143 - root - INFO - epoch=2,number_hard_triplet=441324
2023-08-16 14:27:07,685 - root - INFO - epoch=3,number_hard_triplet=342101
2023-08-16 14:27:09,135 - root - INFO - epoch=4,number_hard_triplet=264548
2023-08-16 14:27:10,565 - root - INFO - epoch=5,number_hard_triplet=200519
2023-08-16 14:27:11,908 - root - INFO - epoch=6,number_hard_triplet=156670
2023-08-16 14:27:13,112 - root - INFO - epoch=7,number_hard_triplet=125678
2023-08-16 14:27:14,502 - root - INFO - epoch=8,number_hard_triplet=93395
2023-08-16 14:27:15,877 - root - INFO - epoch=9,number_hard_triplet=68771
2023-08-16 14:27:16,971 - root - INFO - epoch=10,number_hard_triplet=59585
2023-08-16 14:27:18,492 - root - INFO - epoch=11,number_hard_triplet=42992
2023-08-16 14:27:20,353 - root - INFO - epoch=12,number_hard_triplet=34740
2023-08-16 14:27:21,740 - root - INFO - epoch=13,number_hard_triplet=25049
2023-08-16 14:27:22,779 - root - INFO - epoch=14,number_hard_triplet=23648
2023-08-16 14:27:24,142 - root - INFO - epoch=15,number_hard_triplet=18619
2023-08-16 14:27:25,325 - root - INFO - epoch=16,number_hard_triplet=14984
2023-08-16 14:27:26,380 - root - INFO - epoch=17,number_hard_triplet=13202
2023-08-16 14:27:27,849 - root - INFO - epoch=18,number_hard_triplet=13232
2023-08-16 14:27:28,676 - root - INFO - epoch=19,number_hard_triplet=11683
2023-08-16 14:27:29,530 - root - INFO - epoch=20,number_hard_triplet=8419
2023-08-16 14:27:30,510 - root - INFO - epoch=21,number_hard_triplet=8003
2023-08-16 14:27:31,532 - root - INFO - epoch=22,number_hard_triplet=5981
2023-08-16 14:27:32,686 - root - INFO - epoch=23,number_hard_triplet=6221
2023-08-16 14:27:33,833 - root - INFO - epoch=24,number_hard_triplet=5525
2023-08-16 14:27:35,178 - root - INFO - epoch=25,number_hard_triplet=4624
2023-08-16 14:27:36,478 - root - INFO - epoch=26,number_hard_triplet=3940
2023-08-16 14:27:37,546 - root - INFO - epoch=27,number_hard_triplet=3373
2023-08-16 14:27:38,787 - root - INFO - epoch=28,number_hard_triplet=2881
2023-08-16 14:27:41,480 - root - INFO - epoch=29,number_hard_triplet=2748
2023-08-16 14:27:42,657 - root - INFO - epoch=30,number_hard_triplet=3269
2023-08-16 14:27:44,136 - root - INFO - epoch=31,number_hard_triplet=3276
2023-08-16 14:27:45,384 - root - INFO - epoch=32,number_hard_triplet=2258
2023-08-16 14:27:46,719 - root - INFO - epoch=33,number_hard_triplet=1807
2023-08-16 14:27:47,992 - root - INFO - epoch=34,number_hard_triplet=2101
2023-08-16 14:27:49,125 - root - INFO - epoch=35,number_hard_triplet=1522
2023-08-16 14:27:50,414 - root - INFO - epoch=36,number_hard_triplet=2293
2023-08-16 14:27:51,605 - root - INFO - epoch=37,number_hard_triplet=2433
2023-08-16 14:27:52,511 - root - INFO - epoch=38,number_hard_triplet=1524
2023-08-16 14:27:53,631 - root - INFO - epoch=39,number_hard_triplet=1624
2023-08-16 14:27:54,536 - root - INFO - epoch=40,number_hard_triplet=1261
2023-08-16 14:27:55,700 - root - INFO - epoch=41,number_hard_triplet=1454
2023-08-16 14:27:56,847 - root - INFO - epoch=42,number_hard_triplet=903
2023-08-16 14:27:57,938 - root - INFO - epoch=43,number_hard_triplet=1065
2023-08-16 14:27:59,041 - root - INFO - epoch=44,number_hard_triplet=1005
2023-08-16 14:28:00,327 - root - INFO - epoch=45,number_hard_triplet=900
2023-08-16 14:28:01,165 - root - INFO - epoch=46,number_hard_triplet=1657
2023-08-16 14:28:02,067 - root - INFO - epoch=47,number_hard_triplet=1735
2023-08-16 14:28:02,815 - root - INFO - epoch=48,number_hard_triplet=1064
2023-08-16 14:28:04,031 - root - INFO - epoch=49,number_hard_triplet=1101
2023-08-16 14:28:05,516 - root - INFO - epoch=50,number_hard_triplet=1656
2023-08-16 14:28:05,517 - root - INFO - scDML training done....
2023-08-16 14:28:05,518 - root - INFO - extract embedding for dataset with trained network
