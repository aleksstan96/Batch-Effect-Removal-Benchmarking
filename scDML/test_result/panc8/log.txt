2023-08-01 13:04:33,978 - root - INFO - Create log file....
2023-08-01 13:04:33,995 - root - INFO - Create scDMLModel Object Done....
2023-08-01 13:04:34,009 - root - INFO - Running preprocess() function...
2023-08-01 13:04:34,017 - root - INFO - mode=unsupervised
2023-08-01 13:04:34,023 - root - INFO - clustering method=louvain
2023-08-01 13:04:34,029 - root - INFO - resolution=3.0
2023-08-01 13:04:34,034 - root - INFO - BATCH_key=BATCH
2023-08-01 13:04:34,039 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-08-01 13:04:34,490 - root - INFO - Log1p data
2023-08-01 13:04:34,746 - root - INFO - Select HVG(n_top_genes=1000)
2023-08-01 13:04:36,902 - root - INFO - Scale batch(scale_value=10.0)
2023-08-01 13:04:38,079 - root - INFO - Calculate PCA(n_comps=100)
2023-08-01 13:04:48,416 - root - INFO - Apply louvain clustring(resolution=3.0) initization
2023-08-01 13:04:48,424 - root - INFO - Number of Cluster =34
2023-08-01 13:04:48,432 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33]
2023-08-01 13:04:48,441 - root - INFO - Preprocess Dataset Done...
2023-08-01 13:04:48,446 - root - INFO - mode=unsupervised
2023-08-01 13:04:48,484 - root - INFO - K_in=5,K_bw=10
2023-08-01 13:04:48,490 - root - INFO - Calculate similarity of cluster with KNN and MNN
2023-08-01 13:04:48,513 - root - INFO - appoximate calculate KNN Pair intra batch...
2023-08-01 13:04:48,542 - root - INFO - Calculate KNN pair intra batch...........
2023-08-01 13:04:48,555 - root - INFO - K=5
2023-08-01 13:04:48,567 - root - INFO - metric=cosine
2023-08-01 13:04:48,578 - root - INFO - Processing datasets: (0, 0) = ('celseq', 'celseq')
2023-08-01 13:04:48,734 - root - INFO - There are (6446) KNN pairs when processing (0, 0)=('celseq', 'celseq')
2023-08-01 13:04:48,741 - root - INFO - Processing datasets: (1, 1) = ('celseq2', 'celseq2')
2023-08-01 13:04:48,988 - root - INFO - There are (14680) KNN pairs when processing (1, 1)=('celseq2', 'celseq2')
2023-08-01 13:04:48,995 - root - INFO - Processing datasets: (2, 2) = ('fluidigmc1', 'fluidigmc1')
2023-08-01 13:04:49,053 - root - INFO - There are (4082) KNN pairs when processing (2, 2)=('fluidigmc1', 'fluidigmc1')
2023-08-01 13:04:49,059 - root - INFO - Processing datasets: (3, 3) = ('indrop1', 'indrop1')
2023-08-01 13:04:49,225 - root - INFO - There are (12510) KNN pairs when processing (3, 3)=('indrop1', 'indrop1')
2023-08-01 13:04:49,235 - root - INFO - Processing datasets: (4, 4) = ('indrop2', 'indrop2')
2023-08-01 13:04:49,404 - root - INFO - There are (11066) KNN pairs when processing (4, 4)=('indrop2', 'indrop2')
2023-08-01 13:04:49,422 - root - INFO - Processing datasets: (5, 5) = ('indrop3', 'indrop3')
2023-08-01 13:04:49,778 - root - INFO - There are (23984) KNN pairs when processing (5, 5)=('indrop3', 'indrop3')
2023-08-01 13:04:49,786 - root - INFO - Processing datasets: (6, 6) = ('indrop4', 'indrop4')
2023-08-01 13:04:49,973 - root - INFO - There are (8246) KNN pairs when processing (6, 6)=('indrop4', 'indrop4')
2023-08-01 13:04:49,980 - root - INFO - Processing datasets: (7, 7) = ('smartseq2', 'smartseq2')
2023-08-01 13:04:50,258 - root - INFO - There are (15526) KNN pairs when processing (7, 7)=('smartseq2', 'smartseq2')
2023-08-01 13:04:50,274 - root - INFO - scDML finds (96540) KNN pairs in dataset finally
2023-08-01 13:04:50,920 - root - INFO - appoximate calculate MNN Pair inter batch...
2023-08-01 13:04:50,945 - root - INFO - Calculate MNN pair inter batch...........
2023-08-01 13:04:50,956 - root - INFO - K=10
2023-08-01 13:04:50,962 - root - INFO - metric=cosine
2023-08-01 13:04:50,968 - root - INFO - Processing datasets: (0, 1) = ('celseq', 'celseq2')
2023-08-01 13:04:51,206 - root - INFO - There are (9976) MNN pairs when processing (0, 1)=('celseq', 'celseq2')
2023-08-01 13:04:51,211 - root - INFO - Processing datasets: (0, 2) = ('celseq', 'fluidigmc1')
2023-08-01 13:04:51,280 - root - INFO - There are (4632) MNN pairs when processing (0, 2)=('celseq', 'fluidigmc1')
2023-08-01 13:04:51,285 - root - INFO - Processing datasets: (0, 3) = ('celseq', 'indrop1')
2023-08-01 13:04:51,396 - root - INFO - There are (7548) MNN pairs when processing (0, 3)=('celseq', 'indrop1')
2023-08-01 13:04:51,403 - root - INFO - Processing datasets: (0, 4) = ('celseq', 'indrop2')
2023-08-01 13:04:51,543 - root - INFO - There are (7752) MNN pairs when processing (0, 4)=('celseq', 'indrop2')
2023-08-01 13:04:51,549 - root - INFO - Processing datasets: (0, 5) = ('celseq', 'indrop3')
2023-08-01 13:04:51,814 - root - INFO - There are (8990) MNN pairs when processing (0, 5)=('celseq', 'indrop3')
2023-08-01 13:04:51,821 - root - INFO - Processing datasets: (0, 6) = ('celseq', 'indrop4')
2023-08-01 13:04:51,935 - root - INFO - There are (7370) MNN pairs when processing (0, 6)=('celseq', 'indrop4')
2023-08-01 13:04:51,941 - root - INFO - Processing datasets: (0, 7) = ('celseq', 'smartseq2')
2023-08-01 13:04:52,090 - root - INFO - There are (8962) MNN pairs when processing (0, 7)=('celseq', 'smartseq2')
2023-08-01 13:04:52,099 - root - INFO - Processing datasets: (1, 2) = ('celseq2', 'fluidigmc1')
2023-08-01 13:04:52,273 - root - INFO - There are (6910) MNN pairs when processing (1, 2)=('celseq2', 'fluidigmc1')
2023-08-01 13:04:52,277 - root - INFO - Processing datasets: (1, 3) = ('celseq2', 'indrop1')
2023-08-01 13:04:52,616 - root - INFO - There are (12680) MNN pairs when processing (1, 3)=('celseq2', 'indrop1')
2023-08-01 13:04:52,630 - root - INFO - Processing datasets: (1, 4) = ('celseq2', 'indrop2')
2023-08-01 13:04:52,867 - root - INFO - There are (13112) MNN pairs when processing (1, 4)=('celseq2', 'indrop2')
2023-08-01 13:04:52,881 - root - INFO - Processing datasets: (1, 5) = ('celseq2', 'indrop3')
2023-08-01 13:04:53,286 - root - INFO - There are (14058) MNN pairs when processing (1, 5)=('celseq2', 'indrop3')
2023-08-01 13:04:53,291 - root - INFO - Processing datasets: (1, 6) = ('celseq2', 'indrop4')
2023-08-01 13:04:53,507 - root - INFO - There are (10886) MNN pairs when processing (1, 6)=('celseq2', 'indrop4')
2023-08-01 13:04:53,513 - root - INFO - Processing datasets: (1, 7) = ('celseq2', 'smartseq2')
2023-08-01 13:04:53,800 - root - INFO - There are (14956) MNN pairs when processing (1, 7)=('celseq2', 'smartseq2')
2023-08-01 13:04:53,808 - root - INFO - Processing datasets: (2, 3) = ('fluidigmc1', 'indrop1')
2023-08-01 13:04:54,002 - root - INFO - There are (7352) MNN pairs when processing (2, 3)=('fluidigmc1', 'indrop1')
2023-08-01 13:04:54,009 - root - INFO - Processing datasets: (2, 4) = ('fluidigmc1', 'indrop2')
2023-08-01 13:04:54,273 - root - INFO - There are (6958) MNN pairs when processing (2, 4)=('fluidigmc1', 'indrop2')
2023-08-01 13:04:54,282 - root - INFO - Processing datasets: (2, 5) = ('fluidigmc1', 'indrop3')
2023-08-01 13:04:54,621 - root - INFO - There are (8150) MNN pairs when processing (2, 5)=('fluidigmc1', 'indrop3')
2023-08-01 13:04:54,628 - root - INFO - Processing datasets: (2, 6) = ('fluidigmc1', 'indrop4')
2023-08-01 13:04:54,801 - root - INFO - There are (6836) MNN pairs when processing (2, 6)=('fluidigmc1', 'indrop4')
2023-08-01 13:04:54,804 - root - INFO - Processing datasets: (2, 7) = ('fluidigmc1', 'smartseq2')
2023-08-01 13:04:55,040 - root - INFO - There are (7080) MNN pairs when processing (2, 7)=('fluidigmc1', 'smartseq2')
2023-08-01 13:04:55,047 - root - INFO - Processing datasets: (3, 4) = ('indrop1', 'indrop2')
2023-08-01 13:04:55,352 - root - INFO - There are (12002) MNN pairs when processing (3, 4)=('indrop1', 'indrop2')
2023-08-01 13:04:55,357 - root - INFO - Processing datasets: (3, 5) = ('indrop1', 'indrop3')
2023-08-01 13:04:55,775 - root - INFO - There are (16580) MNN pairs when processing (3, 5)=('indrop1', 'indrop3')
2023-08-01 13:04:55,793 - root - INFO - Processing datasets: (3, 6) = ('indrop1', 'indrop4')
2023-08-01 13:04:56,041 - root - INFO - There are (11160) MNN pairs when processing (3, 6)=('indrop1', 'indrop4')
2023-08-01 13:04:56,071 - root - INFO - Processing datasets: (3, 7) = ('indrop1', 'smartseq2')
2023-08-01 13:04:56,481 - root - INFO - There are (12200) MNN pairs when processing (3, 7)=('indrop1', 'smartseq2')
2023-08-01 13:04:56,488 - root - INFO - Processing datasets: (4, 5) = ('indrop2', 'indrop3')
2023-08-01 13:04:56,911 - root - INFO - There are (14990) MNN pairs when processing (4, 5)=('indrop2', 'indrop3')
2023-08-01 13:04:56,915 - root - INFO - Processing datasets: (4, 6) = ('indrop2', 'indrop4')
2023-08-01 13:04:57,136 - root - INFO - There are (11000) MNN pairs when processing (4, 6)=('indrop2', 'indrop4')
2023-08-01 13:04:57,139 - root - INFO - Processing datasets: (4, 7) = ('indrop2', 'smartseq2')
2023-08-01 13:04:57,390 - root - INFO - There are (13630) MNN pairs when processing (4, 7)=('indrop2', 'smartseq2')
2023-08-01 13:04:57,394 - root - INFO - Processing datasets: (5, 6) = ('indrop3', 'indrop4')
2023-08-01 13:04:57,734 - root - INFO - There are (12960) MNN pairs when processing (5, 6)=('indrop3', 'indrop4')
2023-08-01 13:04:57,739 - root - INFO - Processing datasets: (5, 7) = ('indrop3', 'smartseq2')
2023-08-01 13:04:58,103 - root - INFO - There are (14756) MNN pairs when processing (5, 7)=('indrop3', 'smartseq2')
2023-08-01 13:04:58,109 - root - INFO - Processing datasets: (6, 7) = ('indrop4', 'smartseq2')
2023-08-01 13:04:58,350 - root - INFO - There are (11142) MNN pairs when processing (6, 7)=('indrop4', 'smartseq2')
2023-08-01 13:04:58,354 - root - INFO - scDML finds (294628) MNN pairs in dataset finally
2023-08-01 13:04:59,240 - root - INFO - Find All Nearest Neighbours Done....
2023-08-01 13:04:59,245 - root - INFO - calculate similarity matrix between cluster
2023-08-01 13:04:59,361 - root - INFO - delete inner edge which link same cluster
2023-08-01 13:04:59,365 - root - INFO - 14918 knn pair in batch link different cluster
2023-08-01 13:04:59,498 - root - INFO - delete inner edge which link same cluster
2023-08-01 13:04:59,502 - root - INFO - 180036 mnn pair in batch link different cluster
2023-08-01 13:04:59,521 - root - INFO - ===================================================================================
2023-08-01 13:04:59,536 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=12.068373776645663
2023-08-01 13:04:59,593 - root - INFO - ===================================================================================
2023-08-01 13:04:59,600 - root - INFO - save cor matrix to file....
2023-08-01 13:04:59,608 - root - INFO - save nn pair matrix to file
2023-08-01 13:04:59,614 - root - INFO - Calculate Similarity Matrix Done....
2023-08-01 13:04:59,707 - root - INFO - scDML merge cluster with rule2....
2023-08-01 13:04:59,713 - root - INFO - merge_rule2....
2023-08-01 13:05:00,065 - root - INFO - merging cluster set:[{9}, {14}, {18}, {25}, {27}, {28}, {30}, {31}, {32}, {33}, {17, 10}, {0, 6, 7, 8, 22, 24, 29}, {3, 4, 5, 11, 15, 16, 23}, {1, 26, 19, 12}, {2, 21, 20, 13}]
2023-08-01 13:05:00,077 - root - INFO - Build Embedding Net for scDML training
2023-08-01 13:05:00,089 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-08-01 13:05:00,097 - root - INFO - Build Embedding Net Done...
2023-08-01 13:05:00,104 - root - INFO - train scDML(expect_num_cluster=15) with Embedding Net
2023-08-01 13:05:00,110 - root - INFO - expect_num_cluster=15
2023-08-01 13:05:00,125 - root - INFO - using CPU to train model
2023-08-01 13:05:00,159 - root - INFO - use euclidean distance and hard triplet to train model
2023-08-01 13:05:00,168 - root - INFO - not use earlystopping!!!!
2023-08-01 13:05:03,305 - root - INFO - epoch=1,number_hard_triplet=153605
2023-08-01 13:05:05,293 - root - INFO - epoch=2,number_hard_triplet=59222
2023-08-01 13:05:07,612 - root - INFO - epoch=3,number_hard_triplet=42818
2023-08-01 13:05:10,085 - root - INFO - epoch=4,number_hard_triplet=27513
2023-08-01 13:05:13,049 - root - INFO - epoch=5,number_hard_triplet=22103
2023-08-01 13:05:15,097 - root - INFO - epoch=6,number_hard_triplet=14608
2023-08-01 13:05:17,265 - root - INFO - epoch=7,number_hard_triplet=10676
2023-08-01 13:05:19,014 - root - INFO - epoch=8,number_hard_triplet=8616
2023-08-01 13:05:21,514 - root - INFO - epoch=9,number_hard_triplet=6024
2023-08-01 13:05:23,031 - root - INFO - epoch=10,number_hard_triplet=3563
2023-08-01 13:05:30,436 - root - INFO - epoch=11,number_hard_triplet=3415
2023-08-01 13:05:32,764 - root - INFO - epoch=12,number_hard_triplet=2671
2023-08-01 13:05:34,949 - root - INFO - epoch=13,number_hard_triplet=2447
2023-08-01 13:05:38,186 - root - INFO - epoch=14,number_hard_triplet=2118
2023-08-01 13:05:39,887 - root - INFO - epoch=15,number_hard_triplet=3351
2023-08-01 13:05:41,662 - root - INFO - epoch=16,number_hard_triplet=1724
2023-08-01 13:05:44,036 - root - INFO - epoch=17,number_hard_triplet=1962
2023-08-01 13:05:46,179 - root - INFO - epoch=18,number_hard_triplet=947
2023-08-01 13:05:48,218 - root - INFO - epoch=19,number_hard_triplet=923
2023-08-01 13:05:49,779 - root - INFO - epoch=20,number_hard_triplet=866
2023-08-01 13:05:51,453 - root - INFO - epoch=21,number_hard_triplet=1002
2023-08-01 13:05:54,249 - root - INFO - epoch=22,number_hard_triplet=622
2023-08-01 13:05:58,280 - root - INFO - epoch=23,number_hard_triplet=628
2023-08-01 13:06:00,091 - root - INFO - epoch=24,number_hard_triplet=559
2023-08-01 13:06:02,457 - root - INFO - epoch=25,number_hard_triplet=329
2023-08-01 13:06:05,290 - root - INFO - epoch=26,number_hard_triplet=509
2023-08-01 13:06:07,195 - root - INFO - epoch=27,number_hard_triplet=433
2023-08-01 13:06:09,165 - root - INFO - epoch=28,number_hard_triplet=385
2023-08-01 13:06:11,076 - root - INFO - epoch=29,number_hard_triplet=235
2023-08-01 13:06:12,805 - root - INFO - epoch=30,number_hard_triplet=314
2023-08-01 13:06:14,783 - root - INFO - epoch=31,number_hard_triplet=354
2023-08-01 13:06:17,578 - root - INFO - epoch=32,number_hard_triplet=545
2023-08-01 13:06:19,569 - root - INFO - epoch=33,number_hard_triplet=513
2023-08-01 13:06:22,015 - root - INFO - epoch=34,number_hard_triplet=284
2023-08-01 13:06:24,805 - root - INFO - epoch=35,number_hard_triplet=251
2023-08-01 13:06:30,922 - root - INFO - epoch=36,number_hard_triplet=297
2023-08-01 13:06:37,589 - root - INFO - epoch=37,number_hard_triplet=444
2023-08-01 13:06:41,810 - root - INFO - epoch=38,number_hard_triplet=345
2023-08-01 13:06:45,925 - root - INFO - epoch=39,number_hard_triplet=363
2023-08-01 13:06:49,713 - root - INFO - epoch=40,number_hard_triplet=258
2023-08-01 13:06:54,696 - root - INFO - epoch=41,number_hard_triplet=188
2023-08-01 13:06:57,545 - root - INFO - epoch=42,number_hard_triplet=406
2023-08-01 13:06:59,741 - root - INFO - epoch=43,number_hard_triplet=235
2023-08-01 13:07:03,686 - root - INFO - epoch=44,number_hard_triplet=282
2023-08-01 13:07:06,073 - root - INFO - epoch=45,number_hard_triplet=113
2023-08-01 13:07:08,383 - root - INFO - epoch=46,number_hard_triplet=187
2023-08-01 13:07:11,041 - root - INFO - epoch=47,number_hard_triplet=309
2023-08-01 13:07:13,438 - root - INFO - epoch=48,number_hard_triplet=286
2023-08-01 13:07:15,204 - root - INFO - epoch=49,number_hard_triplet=240
2023-08-01 13:07:17,439 - root - INFO - epoch=50,number_hard_triplet=139
2023-08-01 13:07:17,444 - root - INFO - scDML training done....
2023-08-01 13:07:17,447 - root - INFO - extract embedding for dataset with trained network
2023-08-01 13:07:31,187 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2023-08-01 13:14:42,745 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2023-08-01 13:15:34,270 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2023-08-01 14:10:02,225 - root - INFO - Create log file....
2023-08-01 14:10:02,232 - root - INFO - Create scDMLModel Object Done....
2023-08-01 14:10:02,246 - root - INFO - Running preprocess() function...
2023-08-01 14:10:02,256 - root - INFO - mode=unsupervised
2023-08-01 14:10:02,264 - root - INFO - clustering method=louvain
2023-08-01 14:10:02,270 - root - INFO - resolution=3.0
2023-08-01 14:10:02,276 - root - INFO - BATCH_key=BATCH
2023-08-01 14:10:02,286 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-08-01 14:10:02,698 - root - INFO - Log1p data
2023-08-01 14:10:03,044 - root - INFO - Select HVG(n_top_genes=1000)
2023-08-01 14:10:06,392 - root - INFO - Scale batch(scale_value=10.0)
2023-08-01 14:10:08,723 - root - INFO - Calculate PCA(n_comps=100)
2023-08-01 14:10:17,686 - root - INFO - Apply louvain clustring(resolution=3.0) initization
2023-08-01 14:10:17,692 - root - INFO - Number of Cluster =35
2023-08-01 14:10:17,697 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34]
2023-08-01 14:10:17,703 - root - INFO - Preprocess Dataset Done...
2023-08-01 14:10:17,706 - root - INFO - mode=unsupervised
2023-08-01 14:10:17,747 - root - INFO - K_in=5,K_bw=10
2023-08-01 14:10:17,753 - root - INFO - Calculate similarity of cluster with KNN and MNN
2023-08-01 14:10:17,760 - root - INFO - appoximate calculate KNN Pair intra batch...
2023-08-01 14:10:17,780 - root - INFO - Calculate KNN pair intra batch...........
2023-08-01 14:10:17,786 - root - INFO - K=5
2023-08-01 14:10:17,791 - root - INFO - metric=cosine
2023-08-01 14:10:17,797 - root - INFO - Processing datasets: (0, 0) = ('celseq', 'celseq')
2023-08-01 14:10:17,897 - root - INFO - There are (6636) KNN pairs when processing (0, 0)=('celseq', 'celseq')
2023-08-01 14:10:17,903 - root - INFO - Processing datasets: (1, 1) = ('celseq2', 'celseq2')
2023-08-01 14:10:18,094 - root - INFO - There are (15268) KNN pairs when processing (1, 1)=('celseq2', 'celseq2')
2023-08-01 14:10:18,103 - root - INFO - Processing datasets: (2, 2) = ('fluidigmc1', 'fluidigmc1')
2023-08-01 14:10:18,157 - root - INFO - There are (4020) KNN pairs when processing (2, 2)=('fluidigmc1', 'fluidigmc1')
2023-08-01 14:10:18,162 - root - INFO - Processing datasets: (3, 3) = ('inDrop1', 'inDrop1')
2023-08-01 14:10:18,377 - root - INFO - There are (12568) KNN pairs when processing (3, 3)=('inDrop1', 'inDrop1')
2023-08-01 14:10:18,385 - root - INFO - Processing datasets: (4, 4) = ('inDrop2', 'inDrop2')
2023-08-01 14:10:18,567 - root - INFO - There are (11048) KNN pairs when processing (4, 4)=('inDrop2', 'inDrop2')
2023-08-01 14:10:18,572 - root - INFO - Processing datasets: (5, 5) = ('inDrop3', 'inDrop3')
2023-08-01 14:10:18,890 - root - INFO - There are (24068) KNN pairs when processing (5, 5)=('inDrop3', 'inDrop3')
2023-08-01 14:10:18,895 - root - INFO - Processing datasets: (6, 6) = ('inDrop4', 'inDrop4')
2023-08-01 14:10:19,014 - root - INFO - There are (8364) KNN pairs when processing (6, 6)=('inDrop4', 'inDrop4')
2023-08-01 14:10:19,021 - root - INFO - Processing datasets: (7, 7) = ('smarter', 'smarter')
2023-08-01 14:10:19,189 - root - INFO - There are (9544) KNN pairs when processing (7, 7)=('smarter', 'smarter')
2023-08-01 14:10:19,195 - root - INFO - Processing datasets: (8, 8) = ('smartseq2', 'smartseq2')
2023-08-01 14:10:19,453 - root - INFO - There are (15858) KNN pairs when processing (8, 8)=('smartseq2', 'smartseq2')
2023-08-01 14:10:19,464 - root - INFO - scDML finds (107374) KNN pairs in dataset finally
2023-08-01 14:10:20,362 - root - INFO - appoximate calculate MNN Pair inter batch...
2023-08-01 14:10:20,377 - root - INFO - Calculate MNN pair inter batch...........
2023-08-01 14:10:20,381 - root - INFO - K=10
2023-08-01 14:10:20,386 - root - INFO - metric=cosine
2023-08-01 14:10:20,391 - root - INFO - Processing datasets: (0, 1) = ('celseq', 'celseq2')
2023-08-01 14:10:20,540 - root - INFO - There are (8726) MNN pairs when processing (0, 1)=('celseq', 'celseq2')
2023-08-01 14:10:20,545 - root - INFO - Processing datasets: (0, 2) = ('celseq', 'fluidigmc1')
2023-08-01 14:10:20,628 - root - INFO - There are (4450) MNN pairs when processing (0, 2)=('celseq', 'fluidigmc1')
2023-08-01 14:10:20,640 - root - INFO - Processing datasets: (0, 3) = ('celseq', 'inDrop1')
2023-08-01 14:10:20,766 - root - INFO - There are (7242) MNN pairs when processing (0, 3)=('celseq', 'inDrop1')
2023-08-01 14:10:20,770 - root - INFO - Processing datasets: (0, 4) = ('celseq', 'inDrop2')
2023-08-01 14:10:20,930 - root - INFO - There are (7622) MNN pairs when processing (0, 4)=('celseq', 'inDrop2')
2023-08-01 14:10:20,936 - root - INFO - Processing datasets: (0, 5) = ('celseq', 'inDrop3')
2023-08-01 14:10:21,167 - root - INFO - There are (8978) MNN pairs when processing (0, 5)=('celseq', 'inDrop3')
2023-08-01 14:10:21,173 - root - INFO - Processing datasets: (0, 6) = ('celseq', 'inDrop4')
2023-08-01 14:10:21,285 - root - INFO - There are (7344) MNN pairs when processing (0, 6)=('celseq', 'inDrop4')
2023-08-01 14:10:21,290 - root - INFO - Processing datasets: (0, 7) = ('celseq', 'smarter')
2023-08-01 14:10:21,431 - root - INFO - There are (7098) MNN pairs when processing (0, 7)=('celseq', 'smarter')
2023-08-01 14:10:21,436 - root - INFO - Processing datasets: (0, 8) = ('celseq', 'smartseq2')
2023-08-01 14:10:21,649 - root - INFO - There are (8526) MNN pairs when processing (0, 8)=('celseq', 'smartseq2')
2023-08-01 14:10:21,677 - root - INFO - Processing datasets: (1, 2) = ('celseq2', 'fluidigmc1')
2023-08-01 14:10:21,865 - root - INFO - There are (6754) MNN pairs when processing (1, 2)=('celseq2', 'fluidigmc1')
2023-08-01 14:10:21,874 - root - INFO - Processing datasets: (1, 3) = ('celseq2', 'inDrop1')
2023-08-01 14:10:22,174 - root - INFO - There are (12164) MNN pairs when processing (1, 3)=('celseq2', 'inDrop1')
2023-08-01 14:10:22,180 - root - INFO - Processing datasets: (1, 4) = ('celseq2', 'inDrop2')
2023-08-01 14:10:22,407 - root - INFO - There are (13188) MNN pairs when processing (1, 4)=('celseq2', 'inDrop2')
2023-08-01 14:10:22,411 - root - INFO - Processing datasets: (1, 5) = ('celseq2', 'inDrop3')
2023-08-01 14:10:22,719 - root - INFO - There are (13820) MNN pairs when processing (1, 5)=('celseq2', 'inDrop3')
2023-08-01 14:10:22,725 - root - INFO - Processing datasets: (1, 6) = ('celseq2', 'inDrop4')
2023-08-01 14:10:23,034 - root - INFO - There are (10820) MNN pairs when processing (1, 6)=('celseq2', 'inDrop4')
2023-08-01 14:10:23,043 - root - INFO - Processing datasets: (1, 7) = ('celseq2', 'smarter')
2023-08-01 14:10:23,300 - root - INFO - There are (10316) MNN pairs when processing (1, 7)=('celseq2', 'smarter')
2023-08-01 14:10:23,304 - root - INFO - Processing datasets: (1, 8) = ('celseq2', 'smartseq2')
2023-08-01 14:10:23,672 - root - INFO - There are (14102) MNN pairs when processing (1, 8)=('celseq2', 'smartseq2')
2023-08-01 14:10:23,681 - root - INFO - Processing datasets: (2, 3) = ('fluidigmc1', 'inDrop1')
2023-08-01 14:10:23,854 - root - INFO - There are (6978) MNN pairs when processing (2, 3)=('fluidigmc1', 'inDrop1')
2023-08-01 14:10:23,861 - root - INFO - Processing datasets: (2, 4) = ('fluidigmc1', 'inDrop2')
2023-08-01 14:10:24,053 - root - INFO - There are (7048) MNN pairs when processing (2, 4)=('fluidigmc1', 'inDrop2')
2023-08-01 14:10:24,067 - root - INFO - Processing datasets: (2, 5) = ('fluidigmc1', 'inDrop3')
2023-08-01 14:10:24,301 - root - INFO - There are (7480) MNN pairs when processing (2, 5)=('fluidigmc1', 'inDrop3')
2023-08-01 14:10:24,308 - root - INFO - Processing datasets: (2, 6) = ('fluidigmc1', 'inDrop4')
2023-08-01 14:10:24,496 - root - INFO - There are (6546) MNN pairs when processing (2, 6)=('fluidigmc1', 'inDrop4')
2023-08-01 14:10:24,500 - root - INFO - Processing datasets: (2, 7) = ('fluidigmc1', 'smarter')
2023-08-01 14:10:24,639 - root - INFO - There are (7482) MNN pairs when processing (2, 7)=('fluidigmc1', 'smarter')
2023-08-01 14:10:24,644 - root - INFO - Processing datasets: (2, 8) = ('fluidigmc1', 'smartseq2')
2023-08-01 14:10:24,817 - root - INFO - There are (6914) MNN pairs when processing (2, 8)=('fluidigmc1', 'smartseq2')
2023-08-01 14:10:24,825 - root - INFO - Processing datasets: (3, 4) = ('inDrop1', 'inDrop2')
2023-08-01 14:10:25,093 - root - INFO - There are (11500) MNN pairs when processing (3, 4)=('inDrop1', 'inDrop2')
2023-08-01 14:10:25,099 - root - INFO - Processing datasets: (3, 5) = ('inDrop1', 'inDrop3')
2023-08-01 14:10:25,431 - root - INFO - There are (15430) MNN pairs when processing (3, 5)=('inDrop1', 'inDrop3')
2023-08-01 14:10:25,437 - root - INFO - Processing datasets: (3, 6) = ('inDrop1', 'inDrop4')
2023-08-01 14:10:25,645 - root - INFO - There are (11256) MNN pairs when processing (3, 6)=('inDrop1', 'inDrop4')
2023-08-01 14:10:25,654 - root - INFO - Processing datasets: (3, 7) = ('inDrop1', 'smarter')
2023-08-01 14:10:25,870 - root - INFO - There are (10162) MNN pairs when processing (3, 7)=('inDrop1', 'smarter')
2023-08-01 14:10:25,876 - root - INFO - Processing datasets: (3, 8) = ('inDrop1', 'smartseq2')
2023-08-01 14:10:26,079 - root - INFO - There are (10966) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2023-08-01 14:10:26,086 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2023-08-01 14:10:26,400 - root - INFO - There are (13638) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2023-08-01 14:10:26,406 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2023-08-01 14:10:26,627 - root - INFO - There are (10950) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2023-08-01 14:10:26,633 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2023-08-01 14:10:26,881 - root - INFO - There are (10822) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2023-08-01 14:10:26,885 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2023-08-01 14:10:27,176 - root - INFO - There are (13558) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2023-08-01 14:10:27,180 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2023-08-01 14:10:27,487 - root - INFO - There are (11954) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2023-08-01 14:10:27,493 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2023-08-01 14:10:27,833 - root - INFO - There are (12562) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2023-08-01 14:10:27,838 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2023-08-01 14:10:28,208 - root - INFO - There are (14196) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2023-08-01 14:10:28,212 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2023-08-01 14:10:28,436 - root - INFO - There are (8786) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2023-08-01 14:10:28,441 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2023-08-01 14:10:28,738 - root - INFO - There are (10406) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2023-08-01 14:10:28,743 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2023-08-01 14:10:29,084 - root - INFO - There are (10290) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2023-08-01 14:10:29,090 - root - INFO - scDML finds (360074) MNN pairs in dataset finally
2023-08-01 14:10:30,588 - root - INFO - Find All Nearest Neighbours Done....
2023-08-01 14:10:30,604 - root - INFO - calculate similarity matrix between cluster
2023-08-01 14:10:30,771 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:10:30,778 - root - INFO - 13538 knn pair in batch link different cluster
2023-08-01 14:10:30,958 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:10:30,966 - root - INFO - 230014 mnn pair in batch link different cluster
2023-08-01 14:10:30,970 - root - INFO - ===================================================================================
2023-08-01 14:10:30,975 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=16.990249667602306
2023-08-01 14:10:30,988 - root - INFO - ===================================================================================
2023-08-01 14:10:31,000 - root - INFO - save cor matrix to file....
2023-08-01 14:10:31,011 - root - INFO - save nn pair matrix to file
2023-08-01 14:10:31,026 - root - INFO - Calculate Similarity Matrix Done....
2023-08-01 14:10:31,152 - root - INFO - scDML merge cluster with rule2....
2023-08-01 14:10:31,160 - root - INFO - merge_rule2....
2023-08-01 14:10:31,544 - root - INFO - merging cluster set:[{3}, {5}, {7}, {8}, {14}, {20}, {24}, {25}, {30}, {34}, {1, 19, 28, 17}, {26, 10, 23, 31}, {16, 29}, {0, 33, 2, 4, 12, 15, 18, 21, 22, 27}, {32, 6, 9, 11, 13}]
2023-08-01 14:10:31,552 - root - INFO - Build Embedding Net for scDML training
2023-08-01 14:10:31,568 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-08-01 14:10:31,577 - root - INFO - Build Embedding Net Done...
2023-08-01 14:10:31,588 - root - INFO - train scDML(expect_num_cluster=15) with Embedding Net
2023-08-01 14:10:31,596 - root - INFO - expect_num_cluster=15
2023-08-01 14:10:31,609 - root - INFO - using CPU to train model
2023-08-01 14:10:31,617 - root - INFO - use euclidean distance and hard triplet to train model
2023-08-01 14:10:31,622 - root - INFO - not use earlystopping!!!!
2023-08-01 14:10:34,718 - root - INFO - epoch=1,number_hard_triplet=210128
2023-08-01 14:10:36,724 - root - INFO - epoch=2,number_hard_triplet=106119
2023-08-01 14:10:38,622 - root - INFO - epoch=3,number_hard_triplet=63101
2023-08-01 14:10:40,236 - root - INFO - epoch=4,number_hard_triplet=43748
2023-08-01 14:10:42,201 - root - INFO - epoch=5,number_hard_triplet=33457
2023-08-01 14:10:43,921 - root - INFO - epoch=6,number_hard_triplet=26016
2023-08-01 14:10:45,278 - root - INFO - epoch=7,number_hard_triplet=18975
2023-08-01 14:10:46,853 - root - INFO - epoch=8,number_hard_triplet=14297
2023-08-01 14:10:48,690 - root - INFO - epoch=9,number_hard_triplet=13047
2023-08-01 14:10:50,828 - root - INFO - epoch=10,number_hard_triplet=9882
2023-08-01 14:10:52,494 - root - INFO - epoch=11,number_hard_triplet=7829
2023-08-01 14:10:54,667 - root - INFO - epoch=12,number_hard_triplet=5842
2023-08-01 14:10:56,537 - root - INFO - epoch=13,number_hard_triplet=5489
2023-08-01 14:10:57,917 - root - INFO - epoch=14,number_hard_triplet=4070
2023-08-01 14:10:59,562 - root - INFO - epoch=15,number_hard_triplet=3559
2023-08-01 14:11:01,106 - root - INFO - epoch=16,number_hard_triplet=2527
2023-08-01 14:11:03,256 - root - INFO - epoch=17,number_hard_triplet=2310
2023-08-01 14:11:05,267 - root - INFO - epoch=18,number_hard_triplet=1564
2023-08-01 14:11:07,615 - root - INFO - epoch=19,number_hard_triplet=1467
2023-08-01 14:11:09,394 - root - INFO - epoch=20,number_hard_triplet=1423
2023-08-01 14:11:11,452 - root - INFO - epoch=21,number_hard_triplet=1242
2023-08-01 14:11:14,642 - root - INFO - epoch=22,number_hard_triplet=1145
2023-08-01 14:11:16,211 - root - INFO - epoch=23,number_hard_triplet=785
2023-08-01 14:11:17,583 - root - INFO - epoch=24,number_hard_triplet=1021
2023-08-01 14:11:19,233 - root - INFO - epoch=25,number_hard_triplet=761
2023-08-01 14:11:20,660 - root - INFO - epoch=26,number_hard_triplet=552
2023-08-01 14:11:21,954 - root - INFO - epoch=27,number_hard_triplet=547
2023-08-01 14:11:23,630 - root - INFO - epoch=28,number_hard_triplet=495
2023-08-01 14:11:24,955 - root - INFO - epoch=29,number_hard_triplet=826
2023-08-01 14:11:26,201 - root - INFO - epoch=30,number_hard_triplet=905
2023-08-01 14:11:27,787 - root - INFO - epoch=31,number_hard_triplet=483
2023-08-01 14:11:29,484 - root - INFO - epoch=32,number_hard_triplet=407
2023-08-01 14:11:31,095 - root - INFO - epoch=33,number_hard_triplet=502
2023-08-01 14:11:32,527 - root - INFO - epoch=34,number_hard_triplet=524
2023-08-01 14:11:34,914 - root - INFO - epoch=35,number_hard_triplet=422
2023-08-01 14:11:36,857 - root - INFO - epoch=36,number_hard_triplet=386
2023-08-01 14:11:38,898 - root - INFO - epoch=37,number_hard_triplet=517
2023-08-01 14:11:41,127 - root - INFO - epoch=38,number_hard_triplet=277
2023-08-01 14:11:42,888 - root - INFO - epoch=39,number_hard_triplet=239
2023-08-01 14:11:44,864 - root - INFO - epoch=40,number_hard_triplet=292
2023-08-01 14:11:46,420 - root - INFO - epoch=41,number_hard_triplet=318
2023-08-01 14:11:47,938 - root - INFO - epoch=42,number_hard_triplet=374
2023-08-01 14:11:49,365 - root - INFO - epoch=43,number_hard_triplet=356
2023-08-01 14:11:51,872 - root - INFO - epoch=44,number_hard_triplet=205
2023-08-01 14:11:53,300 - root - INFO - epoch=45,number_hard_triplet=205
2023-08-01 14:11:54,796 - root - INFO - epoch=46,number_hard_triplet=253
2023-08-01 14:11:56,390 - root - INFO - epoch=47,number_hard_triplet=290
2023-08-01 14:11:57,801 - root - INFO - epoch=48,number_hard_triplet=352
2023-08-01 14:11:59,428 - root - INFO - epoch=49,number_hard_triplet=224
2023-08-01 14:12:00,888 - root - INFO - epoch=50,number_hard_triplet=331
2023-08-01 14:12:00,893 - root - INFO - scDML training done....
2023-08-01 14:12:00,897 - root - INFO - extract embedding for dataset with trained network
2023-08-01 14:23:06,171 - root - INFO - Create log file....
2023-08-01 14:23:06,184 - root - INFO - Create scDMLModel Object Done....
2023-08-01 14:23:06,203 - root - INFO - Running preprocess() function...
2023-08-01 14:23:06,265 - root - INFO - mode=unsupervised
2023-08-01 14:23:06,335 - root - INFO - clustering method=louvain
2023-08-01 14:23:06,371 - root - INFO - resolution=1.0
2023-08-01 14:23:06,379 - root - INFO - BATCH_key=BATCH
2023-08-01 14:23:06,387 - root - INFO - Normalize counts per cell(sum=10000.0)
2023-08-01 14:23:06,686 - root - INFO - Log1p data
2023-08-01 14:23:07,010 - root - INFO - Select HVG(n_top_genes=1000)
2023-08-01 14:23:10,347 - root - INFO - Scale batch(scale_value=10.0)
2023-08-01 14:23:12,523 - root - INFO - Calculate PCA(n_comps=100)
2023-08-01 14:23:20,517 - root - INFO - Apply louvain clustring(resolution=1.0) initization
2023-08-01 14:23:20,525 - root - INFO - Number of Cluster =21
2023-08-01 14:23:20,549 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
2023-08-01 14:23:20,563 - root - INFO - Preprocess Dataset Done...
2023-08-01 14:23:20,569 - root - INFO - mode=unsupervised
2023-08-01 14:23:20,612 - root - INFO - K_in=5,K_bw=10
2023-08-01 14:23:20,619 - root - INFO - Calculate similarity of cluster with KNN and MNN
2023-08-01 14:23:20,626 - root - INFO - appoximate calculate KNN Pair intra batch...
2023-08-01 14:23:20,645 - root - INFO - Calculate KNN pair intra batch...........
2023-08-01 14:23:20,652 - root - INFO - K=5
2023-08-01 14:23:20,657 - root - INFO - metric=cosine
2023-08-01 14:23:20,664 - root - INFO - Processing datasets: (0, 0) = ('celseq', 'celseq')
2023-08-01 14:23:20,753 - root - INFO - There are (6636) KNN pairs when processing (0, 0)=('celseq', 'celseq')
2023-08-01 14:23:20,799 - root - INFO - Processing datasets: (1, 1) = ('celseq2', 'celseq2')
2023-08-01 14:23:20,967 - root - INFO - There are (15266) KNN pairs when processing (1, 1)=('celseq2', 'celseq2')
2023-08-01 14:23:20,973 - root - INFO - Processing datasets: (2, 2) = ('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,023 - root - INFO - There are (4020) KNN pairs when processing (2, 2)=('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,029 - root - INFO - Processing datasets: (3, 3) = ('inDrop1', 'inDrop1')
2023-08-01 14:23:21,172 - root - INFO - There are (12568) KNN pairs when processing (3, 3)=('inDrop1', 'inDrop1')
2023-08-01 14:23:21,177 - root - INFO - Processing datasets: (4, 4) = ('inDrop2', 'inDrop2')
2023-08-01 14:23:21,313 - root - INFO - There are (11048) KNN pairs when processing (4, 4)=('inDrop2', 'inDrop2')
2023-08-01 14:23:21,319 - root - INFO - Processing datasets: (5, 5) = ('inDrop3', 'inDrop3')
2023-08-01 14:23:21,614 - root - INFO - There are (24068) KNN pairs when processing (5, 5)=('inDrop3', 'inDrop3')
2023-08-01 14:23:21,619 - root - INFO - Processing datasets: (6, 6) = ('inDrop4', 'inDrop4')
2023-08-01 14:23:21,721 - root - INFO - There are (8364) KNN pairs when processing (6, 6)=('inDrop4', 'inDrop4')
2023-08-01 14:23:21,728 - root - INFO - Processing datasets: (7, 7) = ('smarter', 'smarter')
2023-08-01 14:23:21,869 - root - INFO - There are (9544) KNN pairs when processing (7, 7)=('smarter', 'smarter')
2023-08-01 14:23:21,876 - root - INFO - Processing datasets: (8, 8) = ('smartseq2', 'smartseq2')
2023-08-01 14:23:22,072 - root - INFO - There are (15860) KNN pairs when processing (8, 8)=('smartseq2', 'smartseq2')
2023-08-01 14:23:22,077 - root - INFO - scDML finds (107374) KNN pairs in dataset finally
2023-08-01 14:23:22,195 - root - INFO - appoximate calculate MNN Pair inter batch...
2023-08-01 14:23:22,208 - root - INFO - Calculate MNN pair inter batch...........
2023-08-01 14:23:22,214 - root - INFO - K=10
2023-08-01 14:23:22,218 - root - INFO - metric=cosine
2023-08-01 14:23:22,224 - root - INFO - Processing datasets: (0, 1) = ('celseq', 'celseq2')
2023-08-01 14:23:22,376 - root - INFO - There are (8724) MNN pairs when processing (0, 1)=('celseq', 'celseq2')
2023-08-01 14:23:22,382 - root - INFO - Processing datasets: (0, 2) = ('celseq', 'fluidigmc1')
2023-08-01 14:23:22,486 - root - INFO - There are (4458) MNN pairs when processing (0, 2)=('celseq', 'fluidigmc1')
2023-08-01 14:23:22,500 - root - INFO - Processing datasets: (0, 3) = ('celseq', 'inDrop1')
2023-08-01 14:23:22,676 - root - INFO - There are (7250) MNN pairs when processing (0, 3)=('celseq', 'inDrop1')
2023-08-01 14:23:22,684 - root - INFO - Processing datasets: (0, 4) = ('celseq', 'inDrop2')
2023-08-01 14:23:22,860 - root - INFO - There are (7624) MNN pairs when processing (0, 4)=('celseq', 'inDrop2')
2023-08-01 14:23:22,868 - root - INFO - Processing datasets: (0, 5) = ('celseq', 'inDrop3')
2023-08-01 14:23:23,065 - root - INFO - There are (8982) MNN pairs when processing (0, 5)=('celseq', 'inDrop3')
2023-08-01 14:23:23,073 - root - INFO - Processing datasets: (0, 6) = ('celseq', 'inDrop4')
2023-08-01 14:23:23,187 - root - INFO - There are (7342) MNN pairs when processing (0, 6)=('celseq', 'inDrop4')
2023-08-01 14:23:23,193 - root - INFO - Processing datasets: (0, 7) = ('celseq', 'smarter')
2023-08-01 14:23:23,327 - root - INFO - There are (7080) MNN pairs when processing (0, 7)=('celseq', 'smarter')
2023-08-01 14:23:23,332 - root - INFO - Processing datasets: (0, 8) = ('celseq', 'smartseq2')
2023-08-01 14:23:23,512 - root - INFO - There are (8536) MNN pairs when processing (0, 8)=('celseq', 'smartseq2')
2023-08-01 14:23:23,518 - root - INFO - Processing datasets: (1, 2) = ('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,753 - root - INFO - There are (6758) MNN pairs when processing (1, 2)=('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,758 - root - INFO - Processing datasets: (1, 3) = ('celseq2', 'inDrop1')
2023-08-01 14:23:24,101 - root - INFO - There are (12190) MNN pairs when processing (1, 3)=('celseq2', 'inDrop1')
2023-08-01 14:23:24,118 - root - INFO - Processing datasets: (1, 4) = ('celseq2', 'inDrop2')
2023-08-01 14:23:24,400 - root - INFO - There are (13172) MNN pairs when processing (1, 4)=('celseq2', 'inDrop2')
2023-08-01 14:23:24,408 - root - INFO - Processing datasets: (1, 5) = ('celseq2', 'inDrop3')
2023-08-01 14:23:24,709 - root - INFO - There are (13808) MNN pairs when processing (1, 5)=('celseq2', 'inDrop3')
2023-08-01 14:23:24,715 - root - INFO - Processing datasets: (1, 6) = ('celseq2', 'inDrop4')
2023-08-01 14:23:24,908 - root - INFO - There are (10826) MNN pairs when processing (1, 6)=('celseq2', 'inDrop4')
2023-08-01 14:23:24,921 - root - INFO - Processing datasets: (1, 7) = ('celseq2', 'smarter')
2023-08-01 14:23:25,128 - root - INFO - There are (10402) MNN pairs when processing (1, 7)=('celseq2', 'smarter')
2023-08-01 14:23:25,133 - root - INFO - Processing datasets: (1, 8) = ('celseq2', 'smartseq2')
2023-08-01 14:23:25,391 - root - INFO - There are (14114) MNN pairs when processing (1, 8)=('celseq2', 'smartseq2')
2023-08-01 14:23:25,398 - root - INFO - Processing datasets: (2, 3) = ('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,552 - root - INFO - There are (6966) MNN pairs when processing (2, 3)=('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,557 - root - INFO - Processing datasets: (2, 4) = ('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,699 - root - INFO - There are (7046) MNN pairs when processing (2, 4)=('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,704 - root - INFO - Processing datasets: (2, 5) = ('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,919 - root - INFO - There are (7482) MNN pairs when processing (2, 5)=('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,924 - root - INFO - Processing datasets: (2, 6) = ('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,047 - root - INFO - There are (6548) MNN pairs when processing (2, 6)=('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,052 - root - INFO - Processing datasets: (2, 7) = ('fluidigmc1', 'smarter')
2023-08-01 14:23:26,187 - root - INFO - There are (7470) MNN pairs when processing (2, 7)=('fluidigmc1', 'smarter')
2023-08-01 14:23:26,194 - root - INFO - Processing datasets: (2, 8) = ('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,385 - root - INFO - There are (6936) MNN pairs when processing (2, 8)=('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,392 - root - INFO - Processing datasets: (3, 4) = ('inDrop1', 'inDrop2')
2023-08-01 14:23:26,602 - root - INFO - There are (11496) MNN pairs when processing (3, 4)=('inDrop1', 'inDrop2')
2023-08-01 14:23:26,608 - root - INFO - Processing datasets: (3, 5) = ('inDrop1', 'inDrop3')
2023-08-01 14:23:26,940 - root - INFO - There are (15430) MNN pairs when processing (3, 5)=('inDrop1', 'inDrop3')
2023-08-01 14:23:26,946 - root - INFO - Processing datasets: (3, 6) = ('inDrop1', 'inDrop4')
2023-08-01 14:23:27,153 - root - INFO - There are (11254) MNN pairs when processing (3, 6)=('inDrop1', 'inDrop4')
2023-08-01 14:23:27,158 - root - INFO - Processing datasets: (3, 7) = ('inDrop1', 'smarter')
2023-08-01 14:23:27,365 - root - INFO - There are (10128) MNN pairs when processing (3, 7)=('inDrop1', 'smarter')
2023-08-01 14:23:27,370 - root - INFO - Processing datasets: (3, 8) = ('inDrop1', 'smartseq2')
2023-08-01 14:23:27,629 - root - INFO - There are (10960) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2023-08-01 14:23:27,634 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2023-08-01 14:23:27,906 - root - INFO - There are (13638) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2023-08-01 14:23:27,910 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2023-08-01 14:23:28,104 - root - INFO - There are (10954) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2023-08-01 14:23:28,108 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2023-08-01 14:23:28,307 - root - INFO - There are (10822) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2023-08-01 14:23:28,313 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2023-08-01 14:23:28,584 - root - INFO - There are (13528) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2023-08-01 14:23:28,589 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2023-08-01 14:23:28,910 - root - INFO - There are (11956) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2023-08-01 14:23:28,917 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2023-08-01 14:23:29,284 - root - INFO - There are (12598) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2023-08-01 14:23:29,293 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2023-08-01 14:23:29,666 - root - INFO - There are (14218) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2023-08-01 14:23:29,670 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2023-08-01 14:23:29,865 - root - INFO - There are (8780) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2023-08-01 14:23:29,872 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2023-08-01 14:23:30,170 - root - INFO - There are (10418) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2023-08-01 14:23:30,175 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2023-08-01 14:23:30,433 - root - INFO - There are (10360) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2023-08-01 14:23:30,439 - root - INFO - scDML finds (360254) MNN pairs in dataset finally
2023-08-01 14:23:31,944 - root - INFO - Find All Nearest Neighbours Done....
2023-08-01 14:23:31,952 - root - INFO - calculate similarity matrix between cluster
2023-08-01 14:23:32,018 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,036 - root - INFO - 7170 knn pair in batch link different cluster
2023-08-01 14:23:32,131 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,162 - root - INFO - 173710 mnn pair in batch link different cluster
2023-08-01 14:23:32,198 - root - INFO - ===================================================================================
2023-08-01 14:23:32,220 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=24.22733612273361
2023-08-01 14:23:32,247 - root - INFO - ===================================================================================
2023-08-01 14:23:32,290 - root - INFO - save cor matrix to file....
2023-08-01 14:23:32,301 - root - INFO - save nn pair matrix to file
2023-08-01 14:23:32,308 - root - INFO - Calculate Similarity Matrix Done....
2023-08-01 14:23:32,460 - root - INFO - scDML merge cluster with rule2....
2023-08-01 14:23:32,467 - root - INFO - merge_rule2....
2023-08-01 14:23:32,574 - root - INFO - merging cluster set:[{5}, {6}, {8}, {10}, {11}, {13}, {14}, {16}, {17}, {19}, {20}, {9, 18, 1, 7}, {2, 12}, {0, 3, 4, 15}]
2023-08-01 14:23:32,581 - root - INFO - Build Embedding Net for scDML training
2023-08-01 14:23:32,590 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-08-01 14:23:32,596 - root - INFO - Build Embedding Net Done...
2023-08-01 14:23:32,601 - root - INFO - train scDML(expect_num_cluster=14) with Embedding Net
2023-08-01 14:23:32,607 - root - INFO - expect_num_cluster=14
2023-08-01 14:23:32,626 - root - INFO - using CPU to train model
2023-08-01 14:23:32,637 - root - INFO - use euclidean distance and hard triplet to train model
2023-08-01 14:23:32,644 - root - INFO - not use earlystopping!!!!
2023-08-01 14:23:34,410 - root - INFO - epoch=1,number_hard_triplet=135494
2023-08-01 14:23:36,158 - root - INFO - epoch=2,number_hard_triplet=44181
2023-08-01 14:23:37,817 - root - INFO - epoch=3,number_hard_triplet=25542
2023-08-01 14:23:39,353 - root - INFO - epoch=4,number_hard_triplet=16022
2023-08-01 14:23:40,748 - root - INFO - epoch=5,number_hard_triplet=8235
2023-08-01 14:23:42,224 - root - INFO - epoch=6,number_hard_triplet=6354
2023-08-01 14:23:43,519 - root - INFO - epoch=7,number_hard_triplet=4941
2023-08-01 14:23:45,091 - root - INFO - epoch=8,number_hard_triplet=3500
2023-08-01 14:23:46,402 - root - INFO - epoch=9,number_hard_triplet=3064
2023-08-01 14:23:47,735 - root - INFO - epoch=10,number_hard_triplet=2192
2023-08-01 14:23:49,199 - root - INFO - epoch=11,number_hard_triplet=1760
2023-08-01 14:23:50,554 - root - INFO - epoch=12,number_hard_triplet=1130
2023-08-01 14:23:52,722 - root - INFO - epoch=13,number_hard_triplet=1150
2023-08-01 14:23:55,101 - root - INFO - epoch=14,number_hard_triplet=897
2023-08-01 14:23:56,924 - root - INFO - epoch=15,number_hard_triplet=1113
2023-08-01 14:23:58,285 - root - INFO - epoch=16,number_hard_triplet=817
2023-08-01 14:24:00,337 - root - INFO - epoch=17,number_hard_triplet=714
2023-08-01 14:24:02,595 - root - INFO - epoch=18,number_hard_triplet=682
2023-08-01 14:24:04,712 - root - INFO - epoch=19,number_hard_triplet=442
2023-08-01 14:24:07,234 - root - INFO - epoch=20,number_hard_triplet=441
2023-08-01 14:24:08,761 - root - INFO - epoch=21,number_hard_triplet=355
2023-08-01 14:24:10,218 - root - INFO - epoch=22,number_hard_triplet=497
2023-08-01 14:24:11,506 - root - INFO - epoch=23,number_hard_triplet=518
2023-08-01 14:24:13,059 - root - INFO - epoch=24,number_hard_triplet=370
2023-08-01 14:24:14,493 - root - INFO - epoch=25,number_hard_triplet=235
2023-08-01 14:24:16,204 - root - INFO - epoch=26,number_hard_triplet=476
2023-08-01 14:24:17,504 - root - INFO - epoch=27,number_hard_triplet=237
2023-08-01 14:24:19,040 - root - INFO - epoch=28,number_hard_triplet=269
2023-08-01 14:24:21,251 - root - INFO - epoch=29,number_hard_triplet=343
2023-08-01 14:24:23,098 - root - INFO - epoch=30,number_hard_triplet=277
2023-08-01 14:24:25,119 - root - INFO - epoch=31,number_hard_triplet=290
2023-08-01 14:24:26,756 - root - INFO - epoch=32,number_hard_triplet=263
2023-08-01 14:24:28,288 - root - INFO - epoch=33,number_hard_triplet=246
2023-08-01 14:24:29,658 - root - INFO - epoch=34,number_hard_triplet=278
2023-08-01 14:24:31,080 - root - INFO - epoch=35,number_hard_triplet=222
2023-08-01 14:24:32,422 - root - INFO - epoch=36,number_hard_triplet=137
2023-08-01 14:24:35,286 - root - INFO - epoch=37,number_hard_triplet=143
2023-08-01 14:24:36,838 - root - INFO - epoch=38,number_hard_triplet=135
2023-08-01 14:24:38,177 - root - INFO - epoch=39,number_hard_triplet=251
2023-08-01 14:24:40,457 - root - INFO - epoch=40,number_hard_triplet=184
2023-08-01 14:24:42,006 - root - INFO - epoch=41,number_hard_triplet=205
2023-08-01 14:24:43,518 - root - INFO - epoch=42,number_hard_triplet=223
2023-08-01 14:24:44,853 - root - INFO - epoch=43,number_hard_triplet=185
2023-08-01 14:24:46,998 - root - INFO - epoch=44,number_hard_triplet=145
2023-08-01 14:24:48,525 - root - INFO - epoch=45,number_hard_triplet=128
2023-08-01 14:24:50,370 - root - INFO - epoch=46,number_hard_triplet=158
2023-08-01 14:24:54,551 - root - INFO - epoch=47,number_hard_triplet=162
2023-08-01 14:24:57,167 - root - INFO - epoch=48,number_hard_triplet=124
2023-08-01 14:24:59,603 - root - INFO - epoch=49,number_hard_triplet=207
2023-08-01 14:25:02,320 - root - INFO - epoch=50,number_hard_triplet=229
2023-08-01 14:25:02,338 - root - INFO - scDML training done....
2023-08-01 14:25:02,346 - root - INFO - extract embedding for dataset with trained network
2023-08-01 14:25:17,417 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
celseq')
2023-08-01 14:23:20,753 - root - INFO - There are (6636) KNN pairs when processing (0, 0)=('celseq', 'celseq')
2023-08-01 14:23:20,799 - root - INFO - Processing datasets: (1, 1) = ('celseq2', 'celseq2')
2023-08-01 14:23:20,967 - root - INFO - There are (15266) KNN pairs when processing (1, 1)=('celseq2', 'celseq2')
2023-08-01 14:23:20,973 - root - INFO - Processing datasets: (2, 2) = ('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,023 - root - INFO - There are (4020) KNN pairs when processing (2, 2)=('fluidigmc1', 'fluidigmc1')
2023-08-01 14:23:21,029 - root - INFO - Processing datasets: (3, 3) = ('inDrop1', 'inDrop1')
2023-08-01 14:23:21,172 - root - INFO - There are (12568) KNN pairs when processing (3, 3)=('inDrop1', 'inDrop1')
2023-08-01 14:23:21,177 - root - INFO - Processing datasets: (4, 4) = ('inDrop2', 'inDrop2')
2023-08-01 14:23:21,313 - root - INFO - There are (11048) KNN pairs when processing (4, 4)=('inDrop2', 'inDrop2')
2023-08-01 14:23:21,319 - root - INFO - Processing datasets: (5, 5) = ('inDrop3', 'inDrop3')
2023-08-01 14:23:21,614 - root - INFO - There are (24068) KNN pairs when processing (5, 5)=('inDrop3', 'inDrop3')
2023-08-01 14:23:21,619 - root - INFO - Processing datasets: (6, 6) = ('inDrop4', 'inDrop4')
2023-08-01 14:23:21,721 - root - INFO - There are (8364) KNN pairs when processing (6, 6)=('inDrop4', 'inDrop4')
2023-08-01 14:23:21,728 - root - INFO - Processing datasets: (7, 7) = ('smarter', 'smarter')
2023-08-01 14:23:21,869 - root - INFO - There are (9544) KNN pairs when processing (7, 7)=('smarter', 'smarter')
2023-08-01 14:23:21,876 - root - INFO - Processing datasets: (8, 8) = ('smartseq2', 'smartseq2')
2023-08-01 14:23:22,072 - root - INFO - There are (15860) KNN pairs when processing (8, 8)=('smartseq2', 'smartseq2')
2023-08-01 14:23:22,077 - root - INFO - scDML finds (107374) KNN pairs in dataset finally
2023-08-01 14:23:22,195 - root - INFO - appoximate calculate MNN Pair inter batch...
2023-08-01 14:23:22,208 - root - INFO - Calculate MNN pair inter batch...........
2023-08-01 14:23:22,214 - root - INFO - K=10
2023-08-01 14:23:22,218 - root - INFO - metric=cosine
2023-08-01 14:23:22,224 - root - INFO - Processing datasets: (0, 1) = ('celseq', 'celseq2')
2023-08-01 14:23:22,376 - root - INFO - There are (8724) MNN pairs when processing (0, 1)=('celseq', 'celseq2')
2023-08-01 14:23:22,382 - root - INFO - Processing datasets: (0, 2) = ('celseq', 'fluidigmc1')
2023-08-01 14:23:22,486 - root - INFO - There are (4458) MNN pairs when processing (0, 2)=('celseq', 'fluidigmc1')
2023-08-01 14:23:22,500 - root - INFO - Processing datasets: (0, 3) = ('celseq', 'inDrop1')
2023-08-01 14:23:22,676 - root - INFO - There are (7250) MNN pairs when processing (0, 3)=('celseq', 'inDrop1')
2023-08-01 14:23:22,684 - root - INFO - Processing datasets: (0, 4) = ('celseq', 'inDrop2')
2023-08-01 14:23:22,860 - root - INFO - There are (7624) MNN pairs when processing (0, 4)=('celseq', 'inDrop2')
2023-08-01 14:23:22,868 - root - INFO - Processing datasets: (0, 5) = ('celseq', 'inDrop3')
2023-08-01 14:23:23,065 - root - INFO - There are (8982) MNN pairs when processing (0, 5)=('celseq', 'inDrop3')
2023-08-01 14:23:23,073 - root - INFO - Processing datasets: (0, 6) = ('celseq', 'inDrop4')
2023-08-01 14:23:23,187 - root - INFO - There are (7342) MNN pairs when processing (0, 6)=('celseq', 'inDrop4')
2023-08-01 14:23:23,193 - root - INFO - Processing datasets: (0, 7) = ('celseq', 'smarter')
2023-08-01 14:23:23,327 - root - INFO - There are (7080) MNN pairs when processing (0, 7)=('celseq', 'smarter')
2023-08-01 14:23:23,332 - root - INFO - Processing datasets: (0, 8) = ('celseq', 'smartseq2')
2023-08-01 14:23:23,512 - root - INFO - There are (8536) MNN pairs when processing (0, 8)=('celseq', 'smartseq2')
2023-08-01 14:23:23,518 - root - INFO - Processing datasets: (1, 2) = ('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,753 - root - INFO - There are (6758) MNN pairs when processing (1, 2)=('celseq2', 'fluidigmc1')
2023-08-01 14:23:23,758 - root - INFO - Processing datasets: (1, 3) = ('celseq2', 'inDrop1')
2023-08-01 14:23:24,101 - root - INFO - There are (12190) MNN pairs when processing (1, 3)=('celseq2', 'inDrop1')
2023-08-01 14:23:24,118 - root - INFO - Processing datasets: (1, 4) = ('celseq2', 'inDrop2')
2023-08-01 14:23:24,400 - root - INFO - There are (13172) MNN pairs when processing (1, 4)=('celseq2', 'inDrop2')
2023-08-01 14:23:24,408 - root - INFO - Processing datasets: (1, 5) = ('celseq2', 'inDrop3')
2023-08-01 14:23:24,709 - root - INFO - There are (13808) MNN pairs when processing (1, 5)=('celseq2', 'inDrop3')
2023-08-01 14:23:24,715 - root - INFO - Processing datasets: (1, 6) = ('celseq2', 'inDrop4')
2023-08-01 14:23:24,908 - root - INFO - There are (10826) MNN pairs when processing (1, 6)=('celseq2', 'inDrop4')
2023-08-01 14:23:24,921 - root - INFO - Processing datasets: (1, 7) = ('celseq2', 'smarter')
2023-08-01 14:23:25,128 - root - INFO - There are (10402) MNN pairs when processing (1, 7)=('celseq2', 'smarter')
2023-08-01 14:23:25,133 - root - INFO - Processing datasets: (1, 8) = ('celseq2', 'smartseq2')
2023-08-01 14:23:25,391 - root - INFO - There are (14114) MNN pairs when processing (1, 8)=('celseq2', 'smartseq2')
2023-08-01 14:23:25,398 - root - INFO - Processing datasets: (2, 3) = ('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,552 - root - INFO - There are (6966) MNN pairs when processing (2, 3)=('fluidigmc1', 'inDrop1')
2023-08-01 14:23:25,557 - root - INFO - Processing datasets: (2, 4) = ('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,699 - root - INFO - There are (7046) MNN pairs when processing (2, 4)=('fluidigmc1', 'inDrop2')
2023-08-01 14:23:25,704 - root - INFO - Processing datasets: (2, 5) = ('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,919 - root - INFO - There are (7482) MNN pairs when processing (2, 5)=('fluidigmc1', 'inDrop3')
2023-08-01 14:23:25,924 - root - INFO - Processing datasets: (2, 6) = ('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,047 - root - INFO - There are (6548) MNN pairs when processing (2, 6)=('fluidigmc1', 'inDrop4')
2023-08-01 14:23:26,052 - root - INFO - Processing datasets: (2, 7) = ('fluidigmc1', 'smarter')
2023-08-01 14:23:26,187 - root - INFO - There are (7470) MNN pairs when processing (2, 7)=('fluidigmc1', 'smarter')
2023-08-01 14:23:26,194 - root - INFO - Processing datasets: (2, 8) = ('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,385 - root - INFO - There are (6936) MNN pairs when processing (2, 8)=('fluidigmc1', 'smartseq2')
2023-08-01 14:23:26,392 - root - INFO - Processing datasets: (3, 4) = ('inDrop1', 'inDrop2')
2023-08-01 14:23:26,602 - root - INFO - There are (11496) MNN pairs when processing (3, 4)=('inDrop1', 'inDrop2')
2023-08-01 14:23:26,608 - root - INFO - Processing datasets: (3, 5) = ('inDrop1', 'inDrop3')
2023-08-01 14:23:26,940 - root - INFO - There are (15430) MNN pairs when processing (3, 5)=('inDrop1', 'inDrop3')
2023-08-01 14:23:26,946 - root - INFO - Processing datasets: (3, 6) = ('inDrop1', 'inDrop4')
2023-08-01 14:23:27,153 - root - INFO - There are (11254) MNN pairs when processing (3, 6)=('inDrop1', 'inDrop4')
2023-08-01 14:23:27,158 - root - INFO - Processing datasets: (3, 7) = ('inDrop1', 'smarter')
2023-08-01 14:23:27,365 - root - INFO - There are (10128) MNN pairs when processing (3, 7)=('inDrop1', 'smarter')
2023-08-01 14:23:27,370 - root - INFO - Processing datasets: (3, 8) = ('inDrop1', 'smartseq2')
2023-08-01 14:23:27,629 - root - INFO - There are (10960) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2023-08-01 14:23:27,634 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2023-08-01 14:23:27,906 - root - INFO - There are (13638) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2023-08-01 14:23:27,910 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2023-08-01 14:23:28,104 - root - INFO - There are (10954) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2023-08-01 14:23:28,108 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2023-08-01 14:23:28,307 - root - INFO - There are (10822) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2023-08-01 14:23:28,313 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2023-08-01 14:23:28,584 - root - INFO - There are (13528) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2023-08-01 14:23:28,589 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2023-08-01 14:23:28,910 - root - INFO - There are (11956) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2023-08-01 14:23:28,917 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2023-08-01 14:23:29,284 - root - INFO - There are (12598) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2023-08-01 14:23:29,293 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2023-08-01 14:23:29,666 - root - INFO - There are (14218) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2023-08-01 14:23:29,670 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2023-08-01 14:23:29,865 - root - INFO - There are (8780) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2023-08-01 14:23:29,872 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2023-08-01 14:23:30,170 - root - INFO - There are (10418) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2023-08-01 14:23:30,175 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2023-08-01 14:23:30,433 - root - INFO - There are (10360) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2023-08-01 14:23:30,439 - root - INFO - scDML finds (360254) MNN pairs in dataset finally
2023-08-01 14:23:31,944 - root - INFO - Find All Nearest Neighbours Done....
2023-08-01 14:23:31,952 - root - INFO - calculate similarity matrix between cluster
2023-08-01 14:23:32,018 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,036 - root - INFO - 7170 knn pair in batch link different cluster
2023-08-01 14:23:32,131 - root - INFO - delete inner edge which link same cluster
2023-08-01 14:23:32,162 - root - INFO - 173710 mnn pair in batch link different cluster
2023-08-01 14:23:32,198 - root - INFO - ===================================================================================
2023-08-01 14:23:32,220 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=24.22733612273361
2023-08-01 14:23:32,247 - root - INFO - ===================================================================================
2023-08-01 14:23:32,290 - root - INFO - save cor matrix to file....
2023-08-01 14:23:32,301 - root - INFO - save nn pair matrix to file
2023-08-01 14:23:32,308 - root - INFO - Calculate Similarity Matrix Done....
2023-08-01 14:23:32,460 - root - INFO - scDML merge cluster with rule2....
2023-08-01 14:23:32,467 - root - INFO - merge_rule2....
2023-08-01 14:23:32,574 - root - INFO - merging cluster set:[{5}, {6}, {8}, {10}, {11}, {13}, {14}, {16}, {17}, {19}, {20}, {9, 18, 1, 7}, {2, 12}, {0, 3, 4, 15}]
2023-08-01 14:23:32,581 - root - INFO - Build Embedding Net for scDML training
2023-08-01 14:23:32,590 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2023-08-01 14:23:32,596 - root - INFO - Build Embedding Net Done...
2023-08-01 14:23:32,601 - root - INFO - train scDML(expect_num_cluster=14) with Embedding Net
2023-08-01 14:23:32,607 - root - INFO - expect_num_cluster=14
2023-08-01 14:23:32,626 - root - INFO - using CPU to train model
2023-08-01 14:23:32,637 - root - INFO - use euclidean distance and hard triplet to train model
2023-08-01 14:23:32,644 - root - INFO - not use earlystopping!!!!
2023-08-01 14:23:34,410 - root - INFO - epoch=1,number_hard_triplet=135494
2023-08-01 14:23:36,158 - root - INFO - epoch=2,number_hard_triplet=44181
2023-08-01 14:23:37,817 - root - INFO - epoch=3,number_hard_triplet=25542
2023-08-01 14:23:39,353 - root - INFO - epoch=4,number_hard_triplet=16022
2023-08-01 14:23:40,748 - root - INFO - epoch=5,number_hard_triplet=8235
2023-08-01 14:23:42,224 - root - INFO - epoch=6,number_hard_triplet=6354
2023-08-01 14:23:43,519 - root - INFO - epoch=7,number_hard_triplet=4941
2023-08-01 14:23:45,091 - root - INFO - epoch=8,number_hard_triplet=3500
2023-08-01 14:23:46,402 - root - INFO - epoch=9,number_hard_triplet=3064
2023-08-01 14:23:47,735 - root - INFO - epoch=10,number_hard_triplet=2192
2023-08-01 14:23:49,199 - root - INFO - epoch=11,number_hard_triplet=1760
2023-08-01 14:23:50,554 - root - INFO - epoch=12,number_hard_triplet=1130
2023-08-01 14:23:52,722 - root - INFO - epoch=13,number_hard_triplet=1150
2023-08-01 14:23:55,101 - root - INFO - epoch=14,number_hard_triplet=897
2023-08-01 14:23:56,924 - root - INFO - epoch=15,number_hard_triplet=1113
2023-08-01 14:23:58,285 - root - INFO - epoch=16,number_hard_triplet=817
2023-08-01 14:24:00,337 - root - INFO - epoch=17,number_hard_triplet=714
2023-08-01 14:24:02,595 - root - INFO - epoch=18,number_hard_triplet=682
2023-08-01 14:24:04,712 - root - INFO - epoch=19,number_hard_triplet=442
2023-08-01 14:24:07,234 - root - INFO - epoch=20,number_hard_triplet=441
2023-08-01 14:24:08,761 - root - INFO - epoch=21,number_hard_triplet=355
2023-08-01 14:24:10,218 - root - INFO - epoch=22,number_hard_triplet=497
2023-08-01 14:24:11,506 - root - INFO - epoch=23,number_hard_triplet=518
2023-08-01 14:24:13,059 - root - INFO - epoch=24,number_hard_triplet=370
2023-08-01 14:24:14,493 - root - INFO - epoch=25,number_hard_triplet=235
2023-08-01 14:24:16,204 - root - INFO - epoch=26,number_hard_triplet=476
2023-08-01 14:24:17,504 - root - INFO - epoch=27,number_hard_triplet=237
2023-08-01 14:24:19,040 - root - INFO - epoch=28,number_hard_triplet=269
2023-08-01 14:24:21,251 - root - INFO - epoch=29,number_hard_triplet=343
2023-08-01 14:24:23,098 - root - INFO - epoch=30,number_hard_triplet=277
2023-08-01 14:24:25,119 - root - INFO - epoch=31,number_hard_triplet=290
2023-08-01 14:24:26,756 - root - INFO - epoch=32,number_hard_triplet=263
2023-08-01 14:24:28,288 - root - INFO - epoch=33,number_hard_triplet=246
2023-08-01 14:24:29,658 - root - INFO - epoch=34,number_hard_triplet=278
2023-08-01 14:24:31,080 - root - INFO - epoch=35,number_hard_triplet=222
2023-08-01 14:24:32,422 - root - INFO - epoch=36,number_hard_triplet=137
2023-08-01 14:24:35,286 - root - INFO - epoch=37,number_hard_triplet=143
2023-08-01 14:24:36,838 - root - INFO - epoch=38,number_hard_triplet=135
2023-08-01 14:24:38,177 - root - INFO - epoch=39,number_hard_triplet=251
2023-08-01 14:24:40,457 - root - INFO - epoch=40,number_hard_triplet=184
2023-08-01 14:24:42,006 - root - INFO - epoch=41,number_hard_triplet=205
2023-08-01 14:24:43,518 - root - INFO - epoch=42,number_hard_triplet=223
2023-08-01 14:24:44,853 - root - INFO - epoch=43,number_hard_triplet=185
2023-08-01 14:24:46,998 - root - INFO - epoch=44,number_hard_triplet=145
2023-08-01 14:24:48,525 - root - INFO - epoch=45,number_hard_triplet=128
2023-08-01 14:24:50,370 - root - INFO - epoch=46,number_hard_triplet=158
2023-08-01 14:24:54,551 - root - INFO - epoch=47,number_hard_triplet=162
2023-08-01 14:24:57,167 - root - INFO - epoch=48,number_hard_triplet=124
2023-08-01 14:24:59,603 - root - INFO - epoch=49,number_hard_triplet=207
2023-08-01 14:25:02,320 - root - INFO - epoch=50,number_hard_triplet=229
2023-08-01 14:25:02,338 - root - INFO - scDML training done....
2023-08-01 14:25:02,346 - root - INFO - extract embedding for dataset with trained network
2023-08-01 14:25:17,417 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
